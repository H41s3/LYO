import{j as o,S as Kr,P as Qr,W as Yr,A as Zr,D as ea,G as ta,a as $t,M as Ke,b as me,B as na,c as sa,C as ra,d as aa}from"./three-346a5b60.js";import{r as w,u as ys,R as ce,b as ws,L as Mt,c as ia,d as Ie,B as oa}from"./vendor-71517b70.js";import{m as $,A as yt}from"./ui-b182caf3.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();const xs=w.createContext();function la({children:s}){const[e,t]=w.useState(null),[n,r]=w.useState(!1),u={signUp:async({email:d,password:m})=>(t({email:d}),!0),signIn:async({email:d,password:m})=>(t({email:d}),!0),signOut:()=>{t(null)},user:e,loading:n};return o.jsx(xs.Provider,{value:u,children:s})}function _s(){return w.useContext(xs)}const bs=w.createContext(),ca={voiceEnabled:!1,language:"english",avatarStyle:"holographic",notifications:!1};function ua({children:s}){const[e,t]=w.useState(()=>{const i=localStorage.getItem("lyoSettings");return i?JSON.parse(i):ca});w.useEffect(()=>{e.notifications&&Notification.permission==="default"&&Notification.requestPermission()},[e.notifications]),w.useEffect(()=>{localStorage.setItem("lyoSettings",JSON.stringify(e))},[e]);const a={settings:e,updateSettings:i=>{t(l=>({...l,...i}))},sendNotification:(i,l)=>{e.notifications&&Notification.permission==="granted"&&new Notification(i,{body:l,icon:"/src/assets/lyo-favicon.svg"})}};return o.jsx(bs.Provider,{value:a,children:s})}function wt(){return w.useContext(bs)}const vs=({mood:s=50})=>{const e=w.useRef(),t=w.useRef(),n=w.useRef(),r=w.useRef(),a=w.useRef(),{settings:i}=wt(),l=()=>s<25?16729156:s<50?16096779:s<75?58879:1096065;return w.useEffect(()=>{if(!e.current)return;const u=e.current.clientWidth,d=e.current.clientHeight,m=new Kr;n.current=m;const c=new Qr(50,u/d,.1,1e3);c.position.z=5,r.current=c;const f=new Yr({alpha:!0,antialias:!0});f.setSize(u,d),f.setPixelRatio(window.devicePixelRatio),e.current.appendChild(f.domElement),t.current=f;const h=new Zr(16777215,.5);m.add(h);const g=new ea(16777215,.8);g.position.set(0,10,5),m.add(g),(()=>{a.current&&m.remove(a.current);const p=new ta;if(i.avatarStyle==="holographic"){const S=new $t(1.5,16,16),b=new Ke({color:l(),wireframe:!0,transparent:!0,opacity:.7}),j=new me(S,b);p.add(j);const R=new $t(.15,16,16),P=new Ke({color:l(),transparent:!0,opacity:.9}),D=new me(R,P);D.position.set(-.5,.2,1),p.add(D);const I=new me(R,P);I.position.set(.5,.2,1),p.add(I)}else if(i.avatarStyle==="pixel"){const S=new na(.2,.2,.2),b=new Ke({color:l()});for(let j=-5;j<=5;j++)for(let R=-5;R<=5;R++)if(Math.random()>.7){const P=new me(S,b);P.position.set(j*.2,R*.2,0),p.add(P)}}else if(i.avatarStyle==="cartoon"){const S=new $t(1.2,32,32),b=new sa({color:l(),transparent:!0,opacity:.9}),j=new me(S,b);p.add(j);const R=new ra(.2,32),P=new Ke({color:16777215}),D=new me(R,P);D.position.set(-.4,.2,1.1),p.add(D);const I=new me(R,P);I.position.set(.4,.2,1.1),p.add(I)}m.add(p),a.current=p})();const x=()=>{const p=requestAnimationFrame(x);return a.current&&(a.current.rotation.y+=.005,a.current.position.y=Math.sin(Date.now()*.001)*.1),f.render(m,c),()=>{cancelAnimationFrame(p)}};x();const N=()=>{if(!e.current)return;const p=e.current.clientWidth,S=e.current.clientHeight;c.aspect=p/S,c.updateProjectionMatrix(),f.setSize(p,S)};return window.addEventListener("resize",N),()=>{window.removeEventListener("resize",N),t.current&&e.current&&e.current.removeChild(t.current.domElement)}},[i.avatarStyle]),w.useEffect(()=>{if(!a.current)return;const u=l();a.current.children.forEach(d=>{d.material&&d.material.color.setHex(u)})},[s]),o.jsx($.div,{ref:e,className:"w-full h-full",initial:{opacity:0},animate:{opacity:1},transition:{duration:1}})},da=({onChange:s,initialValue:e=50})=>{const[t,n]=w.useState(e),[r,a]=w.useState(!1),i=w.useRef(null),l=()=>{a(!0)},u=()=>{a(!1)},d=f=>{if(!r||!i.current)return;const h=i.current.getBoundingClientRect(),y=(f.clientX||(f.touches?f.touches[0].clientX:0))-h.left,x=Math.max(0,Math.min(100,y/h.width*100));n(Math.round(x)),s(Math.round(x))};w.useEffect(()=>{const f=g=>d(g),h=g=>d(g);return r&&(window.addEventListener("mousemove",f),window.addEventListener("touchmove",h),window.addEventListener("mouseup",u),window.addEventListener("touchend",u)),()=>{window.removeEventListener("mousemove",f),window.removeEventListener("touchmove",h),window.removeEventListener("mouseup",u),window.removeEventListener("touchend",u)}},[r]);const m=f=>f<25?"Feeling low":f<50?"A bit down":f<75?"Doing okay":"Feeling energetic",c=f=>f<25?"from-error-dark to-error-light":f<50?"from-warning-dark to-warning-light":f<75?"from-neon-blue to-neon-cyan":"from-success-dark to-success-light";return o.jsxs("div",{className:"w-full",children:[o.jsxs("div",{className:"flex justify-between mb-2 text-sm text-gray-400",children:[o.jsx("span",{children:"Low energy"}),o.jsx("span",{children:"High energy"})]}),o.jsxs("div",{ref:i,className:"relative h-2 bg-gray-700 rounded-lg cursor-pointer",onMouseDown:l,onTouchStart:l,children:[o.jsx($.div,{className:`absolute h-full left-0 rounded-l-lg bg-gradient-to-r ${c(t)}`,style:{width:`${t}%`},animate:{width:`${t}%`},transition:{duration:.2}}),o.jsx($.div,{className:"absolute top-1/2 -translate-y-1/2 -ml-3",style:{left:`${t}%`},animate:{left:`${t}%`},transition:{duration:.2},children:o.jsx("div",{className:`w-6 h-6 rounded-full bg-white shadow-lg cursor-grab ${r?"cursor-grabbing scale-110":""} transition-transform duration-200`})})]}),o.jsx("div",{className:"text-center mt-3",children:o.jsx($.span,{className:"text-white font-medium",initial:{opacity:0,y:-5},animate:{opacity:1,y:0},transition:{duration:.3},children:m(t)},m(t))})]})},Ss=w.createContext();function ha({children:s}){const[e,t]=w.useState(50),n={mood:e,setMood:t};return o.jsx(Ss.Provider,{value:n,children:s})}function Cs(){return w.useContext(Ss)}const Jn=["Presence over pressure. Insight over answers. Growth that respects pacing.","Emotions aren't good or bad. They're information.","Clarity comes from engagement, not avoidance.","Your feelings are valid, even when they're complicated.","Small moments of reflection create powerful change.","Understanding yourself is the beginning of growth.","The path to clarity starts with a single honest conversation.","When words fail, presence matters most."],fa=()=>{const[s,e]=w.useState("");return w.useEffect(()=>{const t=Jn[Math.floor(Math.random()*Jn.length)];e(t)},[]),o.jsx($.div,{className:"text-center p-4",initial:{opacity:0},animate:{opacity:.8},transition:{duration:1},children:o.jsxs("p",{className:"text-gray-400 italic text-sm md:text-base",children:['"',s,'"']})})},ma=()=>{const s=ys(),{mood:e,setMood:t}=Cs(),[n,r]=w.useState(!1),a=()=>{r(!0),setTimeout(()=>{s("/chat")},1e3)};return o.jsxs($.div,{className:"min-h-screen flex flex-col justify-center items-center px-4 py-16",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},children:[o.jsxs($.h1,{className:"text-4xl md:text-6xl font-display text-white mb-2 text-center",initial:{y:-50,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5,delay:.2},children:["Meet ",o.jsx("span",{className:"glow-text",children:"LYO"})]}),o.jsx($.p,{className:"text-gray-300 text-center max-w-xl mb-12",initial:{y:-30,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5,delay:.3},children:"Your emotionally intelligent AI companion for clarity and reflection"}),o.jsxs("div",{className:"w-full max-w-6xl flex flex-col items-center",children:[o.jsxs($.div,{className:"relative h-64 md:h-96 w-full max-w-md flex justify-center items-center mb-8",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.8,delay:.4,type:"spring"},children:[o.jsxs("div",{className:"absolute inset-0 flex justify-center items-center",children:[o.jsx("div",{className:"absolute w-48 h-48 md:w-64 md:h-64 rounded-full bg-neon-cyan/20 filter blur-xl animate-pulse"}),o.jsx("div",{className:"absolute w-48 h-48 md:w-64 md:h-64 rounded-full bg-neon-pink/10 filter blur-xl animate-pulse"})]}),o.jsx(vs,{mood:e})]}),o.jsxs($.div,{className:"glass-panel p-6 rounded-2xl w-full max-w-lg mb-8",initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5,delay:.6},children:[o.jsx("h2",{className:"text-lg text-white mb-4 text-center font-display",children:"How are you feeling today?"}),o.jsx(da,{onChange:t,initialValue:e})]}),o.jsx($.div,{className:"flex flex-col sm:flex-row justify-center gap-4 mb-12 w-full max-w-lg",initial:{y:30,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5,delay:.8},children:o.jsxs("button",{onClick:a,disabled:n,className:`neon-button-cyan flex items-center justify-center ${n?"opacity-70 cursor-not-allowed":""}`,children:[n?o.jsx("span",{className:"mr-2",children:o.jsxs("svg",{className:"animate-spin h-5 w-5 text-neon-cyan\\",xmlns:"http://www.w3.org/2000/svg\\",fill:"none\\",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25\\",cx:"12\\",cy:"12\\",r:"10\\",stroke:"currentColor\\",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):null,"Start talking to Lyo"]})}),o.jsx($.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:1,delay:1},className:"w-full max-w-lg",children:o.jsx(fa,{})})]})]})};var As={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Vn=ce.createContext&&ce.createContext(As),ue=globalThis&&globalThis.__assign||function(){return ue=Object.assign||function(s){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(s[r]=e[r])}return s},ue.apply(this,arguments)},ga=globalThis&&globalThis.__rest||function(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(s);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(s,n[r])&&(t[n[r]]=s[n[r]]);return t};function Ps(s){return s&&s.map(function(e,t){return ce.createElement(e.tag,ue({key:t},e.attr),Ps(e.child))})}function z(s){return function(e){return ce.createElement(pa,ue({attr:ue({},s.attr)},e),Ps(s.child))}}function pa(s){var e=function(t){var n=s.attr,r=s.size,a=s.title,i=ga(s,["attr","size","title"]),l=r||t.size||"1em",u;return t.className&&(u=t.className),s.className&&(u=(u?u+" ":"")+s.className),ce.createElement("svg",ue({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,n,i,{className:u,style:ue(ue({color:s.color||t.color},t.style),s.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),a&&ce.createElement("title",null,a),s.children)};return Vn!==void 0?ce.createElement(Vn.Consumer,null,function(t){return e(t)}):e(As)}function ya(s){return z({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"}},{tag:"path",attr:{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"}}]})(s)}function wa(s){return z({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}},{tag:"path",attr:{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"}}]})(s)}function xa(s){return z({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"3",y1:"12",x2:"21",y2:"12"}},{tag:"line",attr:{x1:"3",y1:"6",x2:"21",y2:"6"}},{tag:"line",attr:{x1:"3",y1:"18",x2:"21",y2:"18"}}]})(s)}function _a(s){return z({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"}}]})(s)}function ba(s){return z({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}},{tag:"path",attr:{d:"M19 10v2a7 7 0 0 1-14 0v-2"}},{tag:"line",attr:{x1:"12",y1:"19",x2:"12",y2:"23"}},{tag:"line",attr:{x1:"8",y1:"23",x2:"16",y2:"23"}}]})(s)}function va(s){return z({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 19l7-7 3 3-7 7-3-3z"}},{tag:"path",attr:{d:"M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"}},{tag:"path",attr:{d:"M2 2l7.586 7.586"}},{tag:"circle",attr:{cx:"11",cy:"11",r:"2"}}]})(s)}function Sa(s){return z({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"}},{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"}}]})(s)}function Ca(s){return z({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"22",y1:"2",x2:"11",y2:"13"}},{tag:"polygon",attr:{points:"22 2 15 22 11 13 2 9 22 2"}}]})(s)}function Aa(s){return z({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"}},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"}}]})(s)}function Xn(s){return z({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"1",y:"5",width:"22",height:"14",rx:"7",ry:"7"}},{tag:"circle",attr:{cx:"8",cy:"12",r:"3"}}]})(s)}function Gn(s){return z({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"1",y:"5",width:"22",height:"14",rx:"7",ry:"7"}},{tag:"circle",attr:{cx:"16",cy:"12",r:"3"}}]})(s)}function Rs(s){return z({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"3 6 5 6 21 6"}},{tag:"path",attr:{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}},{tag:"line",attr:{x1:"10",y1:"11",x2:"10",y2:"17"}},{tag:"line",attr:{x1:"14",y1:"11",x2:"14",y2:"17"}}]})(s)}function js(s){return z({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"}},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"}}]})(s)}const Ot=[{id:"normal",label:"Normal Talk",color:"bg-neon-blue",description:"Balanced & thoughtful conversation",behavior:"I respond in a balanced way, offering thoughtful insights while keeping the conversation natural and engaging."},{id:"real",label:"Real Talk",color:"bg-neon-pink",description:"Direct & challenging",behavior:"I'm more direct and willing to challenge your thoughts, while still being supportive and constructive."},{id:"chill",label:"Chill Talk",color:"bg-neon-cyan",description:"Gentle & supportive",behavior:"I keep things relaxed and supportive, focusing on validation and emotional comfort."},{id:"lowbatt",label:"Low-Batt",color:"bg-gray-500",description:"Minimal & comforting",behavior:"I provide brief, comforting responses without asking questions or diving deep."}],Pa=({currentMode:s="normal",onChange:e})=>{const[t,n]=w.useState(!1),r=Ot.find(a=>a.id===s)||Ot[0];return o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>n(!t),className:"mode-button bg-glass-light text-white flex items-center gap-2",children:[o.jsx("span",{className:`w-2 h-2 rounded-full ${r.color}`}),r.label]}),o.jsx(yt,{children:t&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>n(!1)}),o.jsx($.div,{className:"absolute right-0 mt-2 w-64 rounded-lg shadow-lg bg-midnight border border-glass-light overflow-hidden z-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:Ot.map(a=>o.jsxs("button",{className:`w-full text-left p-3 flex flex-col gap-1 ${s===a.id?"bg-glass-medium":"hover:bg-glass-light"}`,onClick:()=>{e(a.id),n(!1)},children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:`w-2 h-2 rounded-full ${a.color}`}),o.jsx("span",{className:"text-white font-medium",children:a.label})]}),o.jsx("p",{className:"text-xs text-gray-400 pl-4",children:a.description})]},a.id))})]})})]})},Xt="RFC3986",Gt={RFC1738:s=>String(s).replace(/%20/g,"+"),RFC3986:s=>String(s)},Ra="RFC1738",ja=Array.isArray,ee=(()=>{const s=[];for(let e=0;e<256;++e)s.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return s})(),Tt=1024,Na=(s,e,t,n,r)=>{if(s.length===0)return s;let a=s;if(typeof s=="symbol"?a=Symbol.prototype.toString.call(s):typeof s!="string"&&(a=String(s)),t==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(l){return"%26%23"+parseInt(l.slice(2),16)+"%3B"});let i="";for(let l=0;l<a.length;l+=Tt){const u=a.length>=Tt?a.slice(l,l+Tt):a,d=[];for(let m=0;m<u.length;++m){let c=u.charCodeAt(m);if(c===45||c===46||c===95||c===126||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||r===Ra&&(c===40||c===41)){d[d.length]=u.charAt(m);continue}if(c<128){d[d.length]=ee[c];continue}if(c<2048){d[d.length]=ee[192|c>>6]+ee[128|c&63];continue}if(c<55296||c>=57344){d[d.length]=ee[224|c>>12]+ee[128|c>>6&63]+ee[128|c&63];continue}m+=1,c=65536+((c&1023)<<10|u.charCodeAt(m)&1023),d[d.length]=ee[240|c>>18]+ee[128|c>>12&63]+ee[128|c>>6&63]+ee[128|c&63]}i+=d.join("")}return i};function Ea(s){return!s||typeof s!="object"?!1:!!(s.constructor&&s.constructor.isBuffer&&s.constructor.isBuffer(s))}function qn(s,e){if(ja(s)){const t=[];for(let n=0;n<s.length;n+=1)t.push(e(s[n]));return t}return e(s)}const ka=Object.prototype.hasOwnProperty,Ns={brackets(s){return String(s)+"[]"},comma:"comma",indices(s,e){return String(s)+"["+e+"]"},repeat(s){return String(s)}},te=Array.isArray,Ia=Array.prototype.push,Es=function(s,e){Ia.apply(s,te(e)?e:[e])},$a=Date.prototype.toISOString,L={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Na,encodeValuesOnly:!1,format:Xt,formatter:Gt[Xt],indices:!1,serializeDate(s){return $a.call(s)},skipNulls:!1,strictNullHandling:!1};function Ma(s){return typeof s=="string"||typeof s=="number"||typeof s=="boolean"||typeof s=="symbol"||typeof s=="bigint"}const Ft={};function ks(s,e,t,n,r,a,i,l,u,d,m,c,f,h,g,y,x,N){let p=s,S=N,b=0,j=!1;for(;(S=S.get(Ft))!==void 0&&!j;){const T=S.get(s);if(b+=1,typeof T<"u"){if(T===b)throw new RangeError("Cyclic object value");j=!0}typeof S.get(Ft)>"u"&&(b=0)}if(typeof d=="function"?p=d(e,p):p instanceof Date?p=f==null?void 0:f(p):t==="comma"&&te(p)&&(p=qn(p,function(T){return T instanceof Date?f==null?void 0:f(T):T})),p===null){if(a)return u&&!y?u(e,L.encoder,x,"key",h):e;p=""}if(Ma(p)||Ea(p)){if(u){const T=y?e:u(e,L.encoder,x,"key",h);return[(g==null?void 0:g(T))+"="+(g==null?void 0:g(u(p,L.encoder,x,"value",h)))]}return[(g==null?void 0:g(e))+"="+(g==null?void 0:g(String(p)))]}const R=[];if(typeof p>"u")return R;let P;if(t==="comma"&&te(p))y&&u&&(p=qn(p,u)),P=[{value:p.length>0?p.join(",")||null:void 0}];else if(te(d))P=d;else{const T=Object.keys(p);P=m?T.sort(m):T}const D=l?String(e).replace(/\./g,"%2E"):String(e),I=n&&te(p)&&p.length===1?D+"[]":D;if(r&&te(p)&&p.length===0)return I+"[]";for(let T=0;T<P.length;++T){const k=P[T],xe=typeof k=="object"&&typeof k.value<"u"?k.value:p[k];if(i&&xe===null)continue;const It=c&&l?k.replace(/\./g,"%2E"):k,zr=te(p)?typeof t=="function"?t(I,It):I:I+(c?"."+It:"["+It+"]");N.set(s,b);const Hn=new WeakMap;Hn.set(Ft,N),Es(R,ks(xe,zr,t,n,r,a,i,l,t==="comma"&&y&&te(p)?null:u,d,m,c,f,h,g,y,x,Hn))}return R}function Oa(s=L){if(typeof s.allowEmptyArrays<"u"&&typeof s.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof s.encodeDotInKeys<"u"&&typeof s.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(s.encoder!==null&&typeof s.encoder<"u"&&typeof s.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=s.charset||L.charset;if(typeof s.charset<"u"&&s.charset!=="utf-8"&&s.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=Xt;if(typeof s.format<"u"){if(!ka.call(Gt,s.format))throw new TypeError("Unknown format option provided.");t=s.format}const n=Gt[t];let r=L.filter;(typeof s.filter=="function"||te(s.filter))&&(r=s.filter);let a;if(s.arrayFormat&&s.arrayFormat in Ns?a=s.arrayFormat:"indices"in s?a=s.indices?"indices":"repeat":a=L.arrayFormat,"commaRoundTrip"in s&&typeof s.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=typeof s.allowDots>"u"?s.encodeDotInKeys?!0:L.allowDots:!!s.allowDots;return{addQueryPrefix:typeof s.addQueryPrefix=="boolean"?s.addQueryPrefix:L.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof s.allowEmptyArrays=="boolean"?!!s.allowEmptyArrays:L.allowEmptyArrays,arrayFormat:a,charset:e,charsetSentinel:typeof s.charsetSentinel=="boolean"?s.charsetSentinel:L.charsetSentinel,commaRoundTrip:!!s.commaRoundTrip,delimiter:typeof s.delimiter>"u"?L.delimiter:s.delimiter,encode:typeof s.encode=="boolean"?s.encode:L.encode,encodeDotInKeys:typeof s.encodeDotInKeys=="boolean"?s.encodeDotInKeys:L.encodeDotInKeys,encoder:typeof s.encoder=="function"?s.encoder:L.encoder,encodeValuesOnly:typeof s.encodeValuesOnly=="boolean"?s.encodeValuesOnly:L.encodeValuesOnly,filter:r,format:t,formatter:n,serializeDate:typeof s.serializeDate=="function"?s.serializeDate:L.serializeDate,skipNulls:typeof s.skipNulls=="boolean"?s.skipNulls:L.skipNulls,sort:typeof s.sort=="function"?s.sort:null,strictNullHandling:typeof s.strictNullHandling=="boolean"?s.strictNullHandling:L.strictNullHandling}}function Ta(s,e={}){let t=s;const n=Oa(e);let r,a;typeof n.filter=="function"?(a=n.filter,t=a("",t)):te(n.filter)&&(a=n.filter,r=a);const i=[];if(typeof t!="object"||t===null)return"";const l=Ns[n.arrayFormat],u=l==="comma"&&n.commaRoundTrip;r||(r=Object.keys(t)),n.sort&&r.sort(n.sort);const d=new WeakMap;for(let f=0;f<r.length;++f){const h=r[f];n.skipNulls&&t[h]===null||Es(i,ks(t[h],h,l,u,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,d))}const m=i.join(n.delimiter);let c=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?c+="utf8=%26%2310003%3B&":c+="utf8=%E2%9C%93&"),m.length>0?c+m:""}const Ce="4.104.0";let zn=!1,Be,Is,$s,qt,Ms,Os,Ts,Fs,Ls;function Fa(s,e={auto:!1}){if(zn)throw new Error(`you must \`import 'openai/shims/${s.kind}'\` before importing anything else from openai`);if(Be)throw new Error(`can't \`import 'openai/shims/${s.kind}'\` after \`import 'openai/shims/${Be}'\``);zn=e.auto,Be=s.kind,Is=s.fetch,s.Request,s.Response,s.Headers,$s=s.FormData,s.Blob,qt=s.File,Ms=s.ReadableStream,Os=s.getMultipartRequestOptions,Ts=s.getDefaultAgent,Fs=s.fileFromPath,Ls=s.isFsReadStream}class La{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function Ba({manuallyImported:s}={}){const e=s?"You may need to use polyfills":"Add one of these imports before your first `import â€¦ from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,n,r,a;try{t=fetch,n=Request,r=Response,a=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${e}`)}return{kind:"web",fetch:t,Request:n,Response:r,Headers:a,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(i,l)=>({...l,body:new La(i)}),getDefaultAgent:i=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:i=>!1}}const Bs=()=>{Be||Fa(Ba(),{auto:!0})};Bs();class v extends Error{}class H extends v{constructor(e,t,n,r){super(`${H.makeMessage(e,t,n)}`),this.status=e,this.headers=r,this.request_id=r==null?void 0:r["x-request-id"],this.error=t;const a=t;this.code=a==null?void 0:a.code,this.param=a==null?void 0:a.param,this.type=a==null?void 0:a.type}static makeMessage(e,t,n){const r=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,n,r){if(!e||!r)return new xt({message:n,cause:Kt(t)});const a=t==null?void 0:t.error;return e===400?new Ds(e,a,n,r):e===401?new Us(e,a,n,r):e===403?new Ws(e,a,n,r):e===404?new Hs(e,a,n,r):e===409?new Js(e,a,n,r):e===422?new Vs(e,a,n,r):e===429?new Xs(e,a,n,r):e>=500?new Gs(e,a,n,r):new H(e,a,n,r)}}class K extends H{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class xt extends H{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class an extends xt{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Ds extends H{}class Us extends H{}class Ws extends H{}class Hs extends H{}class Js extends H{}class Vs extends H{}class Xs extends H{}class Gs extends H{}class qs extends v{constructor(){super("Could not parse response content as the length limit was reached")}}class zs extends v{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var Qe=globalThis&&globalThis.__classPrivateFieldSet||function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},ge=globalThis&&globalThis.__classPrivateFieldGet||function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},G;class _t{constructor(){G.set(this,void 0),this.buffer=new Uint8Array,Qe(this,G,null,"f")}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let n=new Uint8Array(this.buffer.length+t.length);n.set(this.buffer),n.set(t,this.buffer.length),this.buffer=n;const r=[];let a;for(;(a=Da(this.buffer,ge(this,G,"f")))!=null;){if(a.carriage&&ge(this,G,"f")==null){Qe(this,G,a.index,"f");continue}if(ge(this,G,"f")!=null&&(a.index!==ge(this,G,"f")+1||a.carriage)){r.push(this.decodeText(this.buffer.slice(0,ge(this,G,"f")-1))),this.buffer=this.buffer.slice(ge(this,G,"f")),Qe(this,G,null,"f");continue}const i=ge(this,G,"f")!==null?a.preceding-1:a.preceding,l=this.decodeText(this.buffer.slice(0,i));r.push(l),this.buffer=this.buffer.slice(a.index),Qe(this,G,null,"f")}return r}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new v(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new v(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new v("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}G=new WeakMap;_t.NEWLINE_CHARS=new Set([`
`,"\r"]);_t.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Da(s,e){for(let r=e??0;r<s.length;r++){if(s[r]===10)return{preceding:r,index:r+1,carriage:!1};if(s[r]===13)return{preceding:r,index:r+1,carriage:!0}}return null}function Ua(s){for(let n=0;n<s.length-1;n++){if(s[n]===10&&s[n+1]===10||s[n]===13&&s[n+1]===13)return n+2;if(s[n]===13&&s[n+1]===10&&n+3<s.length&&s[n+2]===13&&s[n+3]===10)return n+4}return-1}function Ks(s){if(s[Symbol.asyncIterator])return s;const e=s.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class se{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;async function*r(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let a=!1;try{for await(const i of Wa(e,t))if(!a){if(i.data.startsWith("[DONE]")){a=!0;continue}if(i.event===null||i.event.startsWith("response.")||i.event.startsWith("transcript.")){let l;try{l=JSON.parse(i.data)}catch(u){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),u}if(l&&l.error)throw new H(void 0,l.error,void 0,sr(e.headers));yield l}else{let l;try{l=JSON.parse(i.data)}catch(u){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),u}if(i.event=="error")throw new H(void 0,l.error,l.message,void 0);yield{event:i.event,data:l}}}a=!0}catch(i){if(i instanceof Error&&i.name==="AbortError")return;throw i}finally{a||t.abort()}}return new se(r,t)}static fromReadableStream(e,t){let n=!1;async function*r(){const i=new _t,l=Ks(e);for await(const u of l)for(const d of i.decode(u))yield d;for(const u of i.flush())yield u}async function*a(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let i=!1;try{for await(const l of r())i||l&&(yield JSON.parse(l));i=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{i||t.abort()}}return new se(a,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),r=a=>({next:()=>{if(a.length===0){const i=n.next();e.push(i),t.push(i)}return a.shift()}});return[new se(()=>r(e),this.controller),new se(()=>r(t),this.controller)]}toReadableStream(){const e=this;let t;const n=new TextEncoder;return new Ms({async start(){t=e[Symbol.asyncIterator]()},async pull(r){try{const{value:a,done:i}=await t.next();if(i)return r.close();const l=n.encode(JSON.stringify(a)+`
`);r.enqueue(l)}catch(a){r.error(a)}},async cancel(){var r;await((r=t.return)==null?void 0:r.call(t))}})}}async function*Wa(s,e){if(!s.body)throw e.abort(),new v("Attempted to iterate over a response with no body");const t=new Ja,n=new _t,r=Ks(s.body);for await(const a of Ha(r))for(const i of n.decode(a)){const l=t.decode(i);l&&(yield l)}for(const a of n.flush()){const i=t.decode(a);i&&(yield i)}}async function*Ha(s){let e=new Uint8Array;for await(const t of s){if(t==null)continue;const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let r=new Uint8Array(e.length+n.length);r.set(e),r.set(n,e.length),e=r;let a;for(;(a=Ua(e))!==-1;)yield e.slice(0,a),e=e.slice(a)}e.length>0&&(yield e)}class Ja{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=Va(e,":");return r.startsWith(" ")&&(r=r.substring(1)),t==="event"?this.event=r:t==="data"&&this.data.push(r),null}}function Va(s,e){const t=s.indexOf(e);return t!==-1?[s.substring(0,t),e,s.substring(t+e.length)]:[s,"",""]}const Qs=s=>s!=null&&typeof s=="object"&&typeof s.url=="string"&&typeof s.blob=="function",Ys=s=>s!=null&&typeof s=="object"&&typeof s.name=="string"&&typeof s.lastModified=="number"&&bt(s),bt=s=>s!=null&&typeof s=="object"&&typeof s.size=="number"&&typeof s.type=="string"&&typeof s.text=="function"&&typeof s.slice=="function"&&typeof s.arrayBuffer=="function",Xa=s=>Ys(s)||Qs(s)||Ls(s);async function Zs(s,e,t){var r;if(s=await s,Ys(s))return s;if(Qs(s)){const a=await s.blob();e||(e=new URL(s.url).pathname.split(/[\\/]/).pop()??"unknown_file");const i=bt(a)?[await a.arrayBuffer()]:[a];return new qt(i,e,t)}const n=await Ga(s);if(e||(e=za(s)??"unknown_file"),!(t!=null&&t.type)){const a=(r=n[0])==null?void 0:r.type;typeof a=="string"&&(t={...t,type:a})}return new qt(n,e,t)}async function Ga(s){var t;let e=[];if(typeof s=="string"||ArrayBuffer.isView(s)||s instanceof ArrayBuffer)e.push(s);else if(bt(s))e.push(await s.arrayBuffer());else if(Ka(s))for await(const n of s)e.push(n);else throw new Error(`Unexpected data type: ${typeof s}; constructor: ${(t=s==null?void 0:s.constructor)==null?void 0:t.name}; props: ${qa(s)}`);return e}function qa(s){return`[${Object.getOwnPropertyNames(s).map(t=>`"${t}"`).join(", ")}]`}function za(s){var e;return Lt(s.name)||Lt(s.filename)||((e=Lt(s.path))==null?void 0:e.split(/[\\/]/).pop())}const Lt=s=>{if(typeof s=="string")return s;if(typeof Buffer<"u"&&s instanceof Buffer)return String(s)},Ka=s=>s!=null&&typeof s=="object"&&typeof s[Symbol.asyncIterator]=="function",Kn=s=>s&&typeof s=="object"&&s.body&&s[Symbol.toStringTag]==="MultipartBody",we=async s=>{const e=await Qa(s.body);return Os(e,s)},Qa=async s=>{const e=new $s;return await Promise.all(Object.entries(s||{}).map(([t,n])=>zt(e,t,n))),e},zt=async(s,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")s.append(e,String(t));else if(Xa(t)){const n=await Zs(t);s.append(e,n)}else if(Array.isArray(t))await Promise.all(t.map(n=>zt(s,e+"[]",n)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([n,r])=>zt(s,`${e}[${n}]`,r)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var Ya=globalThis&&globalThis.__classPrivateFieldSet||function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},Za=globalThis&&globalThis.__classPrivateFieldGet||function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},Ye;Bs();async function er(s){var i;const{response:e}=s;if(s.options.stream)return de("response",e.status,e.url,e.headers,e.body),s.options.__streamClass?s.options.__streamClass.fromSSEResponse(e,s.controller):se.fromSSEResponse(e,s.controller);if(e.status===204)return null;if(s.options.__binaryResponse)return e;const t=e.headers.get("content-type"),n=(i=t==null?void 0:t.split(";")[0])==null?void 0:i.trim();if((n==null?void 0:n.includes("application/json"))||(n==null?void 0:n.endsWith("+json"))){const l=await e.json();return de("response",e.status,e.url,e.headers,l),tr(l,e)}const a=await e.text();return de("response",e.status,e.url,e.headers,a),a}function tr(s,e){return!s||typeof s!="object"||Array.isArray(s)?s:Object.defineProperty(s,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class vt extends Promise{constructor(e,t=er){super(n=>{n(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new vt(this.responsePromise,async t=>tr(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class ei{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:r,fetch:a}){this.baseURL=e,this.maxRetries=Bt("maxRetries",t),this.timeout=Bt("timeout",n),this.httpAgent=r,this.fetch=a??Is}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...ai(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${ci()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(async r=>{const a=r&&bt(r==null?void 0:r.body)?new DataView(await r.body.arrayBuffer()):(r==null?void 0:r.body)instanceof DataView?r.body:(r==null?void 0:r.body)instanceof ArrayBuffer?new DataView(r.body):r&&ArrayBuffer.isView(r==null?void 0:r.body)?new DataView(r.body.buffer):r==null?void 0:r.body;return{method:e,path:t,...r,body:a}}))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var y;const n={...e},{method:r,path:a,query:i,headers:l={}}=n,u=ArrayBuffer.isView(n.body)||n.__binaryRequest&&typeof n.body=="string"?n.body:Kn(n.body)?n.body.body:n.body?JSON.stringify(n.body,null,2):null,d=this.calculateContentLength(u),m=this.buildURL(a,i);"timeout"in n&&Bt("timeout",n.timeout),n.timeout=n.timeout??this.timeout;const c=n.httpAgent??this.httpAgent??Ts(m),f=n.timeout+1e3;typeof((y=c==null?void 0:c.options)==null?void 0:y.timeout)=="number"&&f>(c.options.timeout??0)&&(c.options.timeout=f),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=e.idempotencyKey);const h=this.buildHeaders({options:n,headers:l,contentLength:d,retryCount:t});return{req:{method:r,...u&&{body:u},headers:h,...c&&{agent:c},signal:n.signal??null},url:m,timeout:n.timeout}}buildHeaders({options:e,headers:t,contentLength:n,retryCount:r}){const a={};n&&(a["content-length"]=n);const i=this.defaultHeaders(e);return es(a,i),es(a,t),Kn(e.body)&&Be!=="node"&&delete a["content-type"],et(i,"x-stainless-retry-count")===void 0&&et(t,"x-stainless-retry-count")===void 0&&(a["x-stainless-retry-count"]=String(r)),et(i,"x-stainless-timeout")===void 0&&et(t,"x-stainless-timeout")===void 0&&e.timeout&&(a["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(a,t),a}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,n,r){return H.generate(e,t,n,r)}request(e,t=null){return new vt(this.makeRequest(e,t))}async makeRequest(e,t){var c,f;const n=await e,r=n.maxRetries??this.maxRetries;t==null&&(t=r),await this.prepareOptions(n);const{req:a,url:i,timeout:l}=this.buildRequest(n,{retryCount:r-t});if(await this.prepareRequest(a,{url:i,options:n}),de("request",i,n,a.headers),(c=n.signal)!=null&&c.aborted)throw new K;const u=new AbortController,d=await this.fetchWithTimeout(i,a,l,u).catch(Kt);if(d instanceof Error){if((f=n.signal)!=null&&f.aborted)throw new K;if(t)return this.retryRequest(n,t);throw d.name==="AbortError"?new an:new xt({cause:d})}const m=sr(d.headers);if(!d.ok){if(t&&this.shouldRetry(d)){const p=`retrying, ${t} attempts remaining`;return de(`response (error; ${p})`,d.status,i,m),this.retryRequest(n,t,m)}const h=await d.text().catch(p=>Kt(p).message),g=ii(h),y=g?void 0:h;throw de(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,d.status,i,m,y),this.makeStatusError(d.status,g,y,m)}return{response:d,options:n,controller:u}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new ti(this,n,e)}buildURL(e,t){const n=li(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return rr(r)||(t={...r,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new v(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,n,r){const{signal:a,...i}=t||{};a&&a.addEventListener("abort",()=>r.abort());const l=setTimeout(()=>r.abort(),n),u={signal:r.signal,...i};return u.method&&(u.method=u.method.toUpperCase()),this.fetch.call(void 0,e,u).finally(()=>{clearTimeout(l)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n){let r;const a=n==null?void 0:n["retry-after-ms"];if(a){const l=parseFloat(a);Number.isNaN(l)||(r=l)}const i=n==null?void 0:n["retry-after"];if(i&&!r){const l=parseFloat(i);Number.isNaN(l)?r=Date.parse(i)-Date.now():r=l*1e3}if(!(r&&0<=r&&r<60*1e3)){const l=e.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(t,l)}return await He(r),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const a=t-e,i=Math.min(.5*Math.pow(2,a),8),l=1-Math.random()*.25;return i*l*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Ce}`}}class nr{constructor(e,t,n,r){Ye.set(this,void 0),Ya(this,Ye,e,"f"),this.options=r,this.response=t,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new v("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[r,a]of n)e.url.searchParams.set(r,a);t.query=void 0,t.path=e.url.toString()}return await Za(this,Ye,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Ye=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class ti extends vt{constructor(e,t,n){super(t,async r=>new n(e,r.response,await er(r),r.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const sr=s=>new Proxy(Object.fromEntries(s.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}}),ni={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},O=s=>typeof s=="object"&&s!==null&&!rr(s)&&Object.keys(s).every(e=>ar(ni,e)),si=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ce,"X-Stainless-OS":Yn(Deno.build.os),"X-Stainless-Arch":Qn(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ce,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ce,"X-Stainless-OS":Yn(process.platform),"X-Stainless-Arch":Qn(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const s=ri();return s?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ce,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${s.browser}`,"X-Stainless-Runtime-Version":s.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ce,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function ri(){if(typeof navigator>"u"||!navigator)return null;const s=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of s){const n=t.exec(navigator.userAgent);if(n){const r=n[1]||0,a=n[2]||0,i=n[3]||0;return{browser:e,version:`${r}.${a}.${i}`}}}return null}const Qn=s=>s==="x32"?"x32":s==="x86_64"||s==="x64"?"x64":s==="arm"?"arm":s==="aarch64"||s==="arm64"?"arm64":s?`other:${s}`:"unknown",Yn=s=>(s=s.toLowerCase(),s.includes("ios")?"iOS":s==="android"?"Android":s==="darwin"?"MacOS":s==="win32"?"Windows":s==="freebsd"?"FreeBSD":s==="openbsd"?"OpenBSD":s==="linux"?"Linux":s?`Other:${s}`:"Unknown");let Zn;const ai=()=>Zn??(Zn=si()),ii=s=>{try{return JSON.parse(s)}catch{return}},oi=/^[a-z][a-z0-9+.-]*:/i,li=s=>oi.test(s),He=s=>new Promise(e=>setTimeout(e,s)),Bt=(s,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new v(`${s} must be an integer`);if(e<0)throw new v(`${s} must be a positive integer`);return e},Kt=s=>{if(s instanceof Error)return s;if(typeof s=="object"&&s!==null)try{return new Error(JSON.stringify(s))}catch{}return new Error(s)},Ze=s=>{var e,t,n,r,a;if(typeof process<"u")return((t=(e=process.env)==null?void 0:e[s])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(a=(r=(n=Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,s))==null?void 0:a.trim()};function rr(s){if(!s)return!0;for(const e in s)return!1;return!0}function ar(s,e){return Object.prototype.hasOwnProperty.call(s,e)}function es(s,e){for(const t in e){if(!ar(e,t))continue;const n=t.toLowerCase();if(!n)continue;const r=e[t];r===null?delete s[n]:r!==void 0&&(s[n]=r)}}const ts=new Set(["authorization","api-key"]);function de(s,...e){var t;if(typeof process<"u"&&((t=process==null?void 0:process.env)==null?void 0:t.DEBUG)==="true"){const n=e.map(r=>{if(!r)return r;if(r.headers){const i={...r,headers:{...r.headers}};for(const l in r.headers)ts.has(l.toLowerCase())&&(i.headers[l]="REDACTED");return i}let a=null;for(const i in r)ts.has(i.toLowerCase())&&(a??(a={...r}),a[i]="REDACTED");return a??r});console.log(`OpenAI:DEBUG:${s}`,...n)}}const ci=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const e=Math.random()*16|0;return(s==="x"?e:e&3|8).toString(16)}),ui=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",di=s=>typeof(s==null?void 0:s.get)=="function",et=(s,e)=>{var n;const t=e.toLowerCase();if(di(s)){const r=((n=e[0])==null?void 0:n.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(a,i,l)=>i+l.toUpperCase());for(const a of[e,t,e.toUpperCase(),r]){const i=s.get(a);if(i)return i}}for(const[r,a]of Object.entries(s))if(r.toLowerCase()===t)return Array.isArray(a)?(a.length<=1||console.warn(`Received ${a.length} entries for the ${e} header, using the first entry.`),a[0]):a},hi=s=>{if(typeof Buffer<"u"){const e=Buffer.from(s,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(s),t=e.length,n=new Uint8Array(t);for(let r=0;r<t;r++)n[r]=e.charCodeAt(r);return Array.from(new Float32Array(n.buffer))}};function Dt(s){return s!=null&&typeof s=="object"&&!Array.isArray(s)}class St extends nr{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class B extends nr{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var n;const e=this.getPaginatedItems();if(!e.length)return null;const t=(n=e[e.length-1])==null?void 0:n.id;return t?{params:{after:t}}:null}}class C{constructor(e){this._client=e}}let ir=class extends C{list(e,t={},n){return O(t)?this.list(e,{},t):this._client.getAPIList(`/chat/completions/${e}/messages`,fi,{query:t,...n})}},Ct=class extends C{constructor(){super(...arguments),this.messages=new ir(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(`/chat/completions/${e}`,t)}update(e,t,n){return this._client.post(`/chat/completions/${e}`,{body:t,...n})}list(e={},t){return O(e)?this.list({},e):this._client.getAPIList("/chat/completions",At,{query:e,...t})}del(e,t){return this._client.delete(`/chat/completions/${e}`,t)}};class At extends B{}class fi extends B{}Ct.ChatCompletionsPage=At;Ct.Messages=ir;let Pt=class extends C{constructor(){super(...arguments),this.completions=new Ct(this._client)}};Pt.Completions=Ct;Pt.ChatCompletionsPage=At;class or extends C{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t==null?void 0:t.headers},__binaryResponse:!0})}}class lr extends C{create(e,t){return this._client.post("/audio/transcriptions",we({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}}))}}class cr extends C{create(e,t){return this._client.post("/audio/translations",we({body:e,...t,__metadata:{model:e.model}}))}}class Je extends C{constructor(){super(...arguments),this.transcriptions=new lr(this._client),this.translations=new cr(this._client),this.speech=new or(this._client)}}Je.Transcriptions=lr;Je.Translations=cr;Je.Speech=or;class on extends C{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return O(e)?this.list({},e):this._client.getAPIList("/batches",ln,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class ln extends B{}on.BatchesPage=ln;var Q=globalThis&&globalThis.__classPrivateFieldSet||function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},M=globalThis&&globalThis.__classPrivateFieldGet||function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},Qt,ot,lt,$e,Me,ct,Oe,ae,Te,ft,mt,Ae,ur;class cn{constructor(){Qt.add(this),this.controller=new AbortController,ot.set(this,void 0),lt.set(this,()=>{}),$e.set(this,()=>{}),Me.set(this,void 0),ct.set(this,()=>{}),Oe.set(this,()=>{}),ae.set(this,{}),Te.set(this,!1),ft.set(this,!1),mt.set(this,!1),Ae.set(this,!1),Q(this,ot,new Promise((e,t)=>{Q(this,lt,e,"f"),Q(this,$e,t,"f")}),"f"),Q(this,Me,new Promise((e,t)=>{Q(this,ct,e,"f"),Q(this,Oe,t,"f")}),"f"),M(this,ot,"f").catch(()=>{}),M(this,Me,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},M(this,Qt,"m",ur).bind(this))},0)}_connected(){this.ended||(M(this,lt,"f").call(this),this._emit("connect"))}get ended(){return M(this,Te,"f")}get errored(){return M(this,ft,"f")}get aborted(){return M(this,mt,"f")}abort(){this.controller.abort()}on(e,t){return(M(this,ae,"f")[e]||(M(this,ae,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=M(this,ae,"f")[e];if(!n)return this;const r=n.findIndex(a=>a.listener===t);return r>=0&&n.splice(r,1),this}once(e,t){return(M(this,ae,"f")[e]||(M(this,ae,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,n)=>{Q(this,Ae,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,t)})}async done(){Q(this,Ae,!0,"f"),await M(this,Me,"f")}_emit(e,...t){if(M(this,Te,"f"))return;e==="end"&&(Q(this,Te,!0,"f"),M(this,ct,"f").call(this));const n=M(this,ae,"f")[e];if(n&&(M(this,ae,"f")[e]=n.filter(r=>!r.once),n.forEach(({listener:r})=>r(...t))),e==="abort"){const r=t[0];!M(this,Ae,"f")&&!(n!=null&&n.length)&&Promise.reject(r),M(this,$e,"f").call(this,r),M(this,Oe,"f").call(this,r),this._emit("end");return}if(e==="error"){const r=t[0];!M(this,Ae,"f")&&!(n!=null&&n.length)&&Promise.reject(r),M(this,$e,"f").call(this,r),M(this,Oe,"f").call(this,r),this._emit("end")}}_emitFinal(){}}ot=new WeakMap,lt=new WeakMap,$e=new WeakMap,Me=new WeakMap,ct=new WeakMap,Oe=new WeakMap,ae=new WeakMap,Te=new WeakMap,ft=new WeakMap,mt=new WeakMap,Ae=new WeakMap,Qt=new WeakSet,ur=function(e){if(Q(this,ft,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new K),e instanceof K)return Q(this,mt,!0,"f"),this._emit("abort",e);if(e instanceof v)return this._emit("error",e);if(e instanceof Error){const t=new v(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new v(String(e)))};var _=globalThis&&globalThis.__classPrivateFieldGet||function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},X=globalThis&&globalThis.__classPrivateFieldSet||function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},W,Yt,ne,ut,Y,ye,Pe,pe,gt,q,dt,ht,De,Fe,Le,ns,ss,rs,as,is,os,ls;class Z extends cn{constructor(){super(...arguments),W.add(this),Yt.set(this,[]),ne.set(this,{}),ut.set(this,{}),Y.set(this,void 0),ye.set(this,void 0),Pe.set(this,void 0),pe.set(this,void 0),gt.set(this,void 0),q.set(this,void 0),dt.set(this,void 0),ht.set(this,void 0),De.set(this,void 0)}[(Yt=new WeakMap,ne=new WeakMap,ut=new WeakMap,Y=new WeakMap,ye=new WeakMap,Pe=new WeakMap,pe=new WeakMap,gt=new WeakMap,q=new WeakMap,dt=new WeakMap,ht=new WeakMap,De=new WeakMap,W=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",r=>{const a=t.shift();a?a.resolve(r):e.push(r)}),this.on("end",()=>{n=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),this.on("error",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,i)=>t.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new Z;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){var a;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const r=se.fromReadableStream(e,this.controller);for await(const i of r)_(this,W,"m",Fe).call(this,i);if((a=r.controller.signal)!=null&&a.aborted)throw new K;return this._addRun(_(this,W,"m",Le).call(this))}toReadableStream(){return new se(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,n,r,a){const i=new Z;return i._run(()=>i._runToolAssistantStream(e,t,n,r,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(e,t,n,r,a){var d;const i=a==null?void 0:a.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const l={...r,stream:!0},u=await e.submitToolOutputs(t,n,l,{...a,signal:this.controller.signal});this._connected();for await(const m of u)_(this,W,"m",Fe).call(this,m);if((d=u.controller.signal)!=null&&d.aborted)throw new K;return this._addRun(_(this,W,"m",Le).call(this))}static createThreadAssistantStream(e,t,n){const r=new Z;return r._run(()=>r._threadAssistantStream(e,t,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),r}static createAssistantStream(e,t,n,r){const a=new Z;return a._run(()=>a._runAssistantStream(e,t,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}currentEvent(){return _(this,dt,"f")}currentRun(){return _(this,ht,"f")}currentMessageSnapshot(){return _(this,Y,"f")}currentRunStepSnapshot(){return _(this,De,"f")}async finalRunSteps(){return await this.done(),Object.values(_(this,ne,"f"))}async finalMessages(){return await this.done(),Object.values(_(this,ut,"f"))}async finalRun(){if(await this.done(),!_(this,ye,"f"))throw Error("Final run was not received.");return _(this,ye,"f")}async _createThreadAssistantStream(e,t,n){var l;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));const a={...t,stream:!0},i=await e.createAndRun(a,{...n,signal:this.controller.signal});this._connected();for await(const u of i)_(this,W,"m",Fe).call(this,u);if((l=i.controller.signal)!=null&&l.aborted)throw new K;return this._addRun(_(this,W,"m",Le).call(this))}async _createAssistantStream(e,t,n,r){var u;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},l=await e.create(t,i,{...r,signal:this.controller.signal});this._connected();for await(const d of l)_(this,W,"m",Fe).call(this,d);if((u=l.controller.signal)!=null&&u.aborted)throw new K;return this._addRun(_(this,W,"m",Le).call(this))}static accumulateDelta(e,t){for(const[n,r]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=r;continue}let a=e[n];if(a==null){e[n]=r;continue}if(n==="index"||n==="type"){e[n]=r;continue}if(typeof a=="string"&&typeof r=="string")a+=r;else if(typeof a=="number"&&typeof r=="number")a+=r;else if(Dt(a)&&Dt(r))a=this.accumulateDelta(a,r);else if(Array.isArray(a)&&Array.isArray(r)){if(a.every(i=>typeof i=="string"||typeof i=="number")){a.push(...r);continue}for(const i of r){if(!Dt(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);const l=i.index;if(l==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof l!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${l}`);const u=a[l];u==null?a.push(i):a[l]=this.accumulateDelta(u,i)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${r}, accValue: ${a}`);e[n]=a}return e}_addRun(e){return e}async _threadAssistantStream(e,t,n){return await this._createThreadAssistantStream(t,e,n)}async _runAssistantStream(e,t,n,r){return await this._createAssistantStream(t,e,n,r)}async _runToolAssistantStream(e,t,n,r,a){return await this._createToolAssistantStream(n,e,t,r,a)}}Fe=function(e){if(!this.ended)switch(X(this,dt,e,"f"),_(this,W,"m",rs).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":_(this,W,"m",ls).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":_(this,W,"m",ss).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":_(this,W,"m",ns).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Le=function(){if(this.ended)throw new v("stream has ended, this shouldn't happen");if(!_(this,ye,"f"))throw Error("Final run has not been received");return _(this,ye,"f")},ns=function(e){const[t,n]=_(this,W,"m",is).call(this,e,_(this,Y,"f"));X(this,Y,t,"f"),_(this,ut,"f")[t.id]=t;for(const r of n){const a=t.content[r.index];(a==null?void 0:a.type)=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const r of e.data.delta.content){if(r.type=="text"&&r.text){let a=r.text,i=t.content[r.index];if(i&&i.type=="text")this._emit("textDelta",a,i.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(r.index!=_(this,Pe,"f")){if(_(this,pe,"f"))switch(_(this,pe,"f").type){case"text":this._emit("textDone",_(this,pe,"f").text,_(this,Y,"f"));break;case"image_file":this._emit("imageFileDone",_(this,pe,"f").image_file,_(this,Y,"f"));break}X(this,Pe,r.index,"f")}X(this,pe,t.content[r.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(_(this,Pe,"f")!==void 0){const r=e.data.content[_(this,Pe,"f")];if(r)switch(r.type){case"image_file":this._emit("imageFileDone",r.image_file,_(this,Y,"f"));break;case"text":this._emit("textDone",r.text,_(this,Y,"f"));break}}_(this,Y,"f")&&this._emit("messageDone",e.data),X(this,Y,void 0,"f")}},ss=function(e){const t=_(this,W,"m",as).call(this,e);switch(X(this,De,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const a of n.step_details.tool_calls)a.index==_(this,gt,"f")?this._emit("toolCallDelta",a,t.step_details.tool_calls[a.index]):(_(this,q,"f")&&this._emit("toolCallDone",_(this,q,"f")),X(this,gt,a.index,"f"),X(this,q,t.step_details.tool_calls[a.index],"f"),_(this,q,"f")&&this._emit("toolCallCreated",_(this,q,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":X(this,De,void 0,"f"),e.data.step_details.type=="tool_calls"&&_(this,q,"f")&&(this._emit("toolCallDone",_(this,q,"f")),X(this,q,void 0,"f")),this._emit("runStepDone",e.data,t);break}},rs=function(e){_(this,Yt,"f").push(e),this._emit("event",e)},as=function(e){switch(e.event){case"thread.run.step.created":return _(this,ne,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=_(this,ne,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const r=Z.accumulateDelta(t,n.delta);_(this,ne,"f")[e.data.id]=r}return _(this,ne,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":_(this,ne,"f")[e.data.id]=e.data;break}if(_(this,ne,"f")[e.data.id])return _(this,ne,"f")[e.data.id];throw new Error("No snapshot available")},is=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=e.data;if(r.delta.content)for(const a of r.delta.content)if(a.index in t.content){let i=t.content[a.index];t.content[a.index]=_(this,W,"m",os).call(this,a,i)}else t.content[a.index]=a,n.push(a);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},os=function(e,t){return Z.accumulateDelta(t,e)},ls=function(e){switch(X(this,ht,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":X(this,ye,e.data,"f"),_(this,q,"f")&&(this._emit("toolCallDone",_(this,q,"f")),X(this,q,void 0,"f"));break}};class un extends C{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/assistants/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},t){return O(e)?this.list({},e):this._client.getAPIList("/assistants",dn,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class dn extends B{}un.AssistantsPage=dn;function cs(s){return typeof s.parse=="function"}const Re=s=>(s==null?void 0:s.role)==="assistant",dr=s=>(s==null?void 0:s.role)==="function",hr=s=>(s==null?void 0:s.role)==="tool";function hn(s){return(s==null?void 0:s.$brand)==="auto-parseable-response-format"}function Ve(s){return(s==null?void 0:s.$brand)==="auto-parseable-tool"}function mi(s,e){return!e||!fr(e)?{...s,choices:s.choices.map(t=>({...t,message:{...t.message,parsed:null,...t.message.tool_calls?{tool_calls:t.message.tool_calls}:void 0}}))}:fn(s,e)}function fn(s,e){const t=s.choices.map(n=>{var r;if(n.finish_reason==="length")throw new qs;if(n.finish_reason==="content_filter")throw new zs;return{...n,message:{...n.message,...n.message.tool_calls?{tool_calls:((r=n.message.tool_calls)==null?void 0:r.map(a=>pi(e,a)))??void 0}:void 0,parsed:n.message.content&&!n.message.refusal?gi(e,n.message.content):null}}});return{...s,choices:t}}function gi(s,e){var t,n;return((t=s.response_format)==null?void 0:t.type)!=="json_schema"?null:((n=s.response_format)==null?void 0:n.type)==="json_schema"?"$parseRaw"in s.response_format?s.response_format.$parseRaw(e):JSON.parse(e):null}function pi(s,e){var n;const t=(n=s.tools)==null?void 0:n.find(r=>{var a;return((a=r.function)==null?void 0:a.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:Ve(t)?t.$parseRaw(e.function.arguments):t!=null&&t.function.strict?JSON.parse(e.function.arguments):null}}}function yi(s,e){var n;if(!s)return!1;const t=(n=s.tools)==null?void 0:n.find(r=>{var a;return((a=r.function)==null?void 0:a.name)===e.function.name});return Ve(t)||(t==null?void 0:t.function.strict)||!1}function fr(s){var e;return hn(s.response_format)?!0:((e=s.tools)==null?void 0:e.some(t=>Ve(t)||t.type==="function"&&t.function.strict===!0))??!1}function wi(s){for(const e of s??[]){if(e.type!=="function")throw new v(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new v(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var V=globalThis&&globalThis.__classPrivateFieldGet||function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},J,Zt,pt,en,tn,nn,mr,sn;const us=10;class gr extends cn{constructor(){super(...arguments),J.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var n;this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=(n=e.choices[0])==null?void 0:n.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(dr(e)||hr(e))&&e.content)this._emit("functionCallResult",e.content);else if(Re(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Re(e)&&e.tool_calls)for(const n of e.tool_calls)n.type==="function"&&this._emit("functionCall",n.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new v("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),V(this,J,"m",Zt).call(this)}async finalMessage(){return await this.done(),V(this,J,"m",pt).call(this)}async finalFunctionCall(){return await this.done(),V(this,J,"m",en).call(this)}async finalFunctionCallResult(){return await this.done(),V(this,J,"m",tn).call(this)}async totalUsage(){return await this.done(),V(this,J,"m",nn).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=V(this,J,"m",pt).call(this);t&&this._emit("finalMessage",t);const n=V(this,J,"m",Zt).call(this);n&&this._emit("finalContent",n);const r=V(this,J,"m",en).call(this);r&&this._emit("finalFunctionCall",r);const a=V(this,J,"m",tn).call(this);a!=null&&this._emit("finalFunctionCallResult",a),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",V(this,J,"m",nn).call(this))}async _createChatCompletion(e,t,n){const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),V(this,J,"m",mr).call(this,t);const a=await e.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(fn(a,t))}async _runChatCompletion(e,t,n){for(const r of t.messages)this._addMessage(r,!1);return await this._createChatCompletion(e,t,n)}async _runFunctions(e,t,n){var f;const r="function",{function_call:a="auto",stream:i,...l}=t,u=typeof a!="string"&&(a==null?void 0:a.name),{maxChatCompletions:d=us}=n||{},m={};for(const h of t.functions)m[h.name||h.function.name]=h;const c=t.functions.map(h=>({name:h.name||h.function.name,parameters:h.parameters,description:h.description}));for(const h of t.messages)this._addMessage(h,!1);for(let h=0;h<d;++h){const y=(f=(await this._createChatCompletion(e,{...l,function_call:a,functions:c,messages:[...this.messages]},n)).choices[0])==null?void 0:f.message;if(!y)throw new v("missing message in ChatCompletion response");if(!y.function_call)return;const{name:x,arguments:N}=y.function_call,p=m[x];if(p){if(u&&u!==x){const R=`Invalid function_call: ${JSON.stringify(x)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:r,name:x,content:R});continue}}else{const R=`Invalid function_call: ${JSON.stringify(x)}. Available options are: ${c.map(P=>JSON.stringify(P.name)).join(", ")}. Please try again`;this._addMessage({role:r,name:x,content:R});continue}let S;try{S=cs(p)?await p.parse(N):N}catch(R){this._addMessage({role:r,name:x,content:R instanceof Error?R.message:String(R)});continue}const b=await p.function(S,this),j=V(this,J,"m",sn).call(this,b);if(this._addMessage({role:r,name:x,content:j}),u)return}}async _runTools(e,t,n){var h,g,y;const r="tool",{tool_choice:a="auto",stream:i,...l}=t,u=typeof a!="string"&&((h=a==null?void 0:a.function)==null?void 0:h.name),{maxChatCompletions:d=us}=n||{},m=t.tools.map(x=>{if(Ve(x)){if(!x.$callback)throw new v("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:x.$callback,name:x.function.name,description:x.function.description||"",parameters:x.function.parameters,parse:x.$parseRaw,strict:!0}}}return x}),c={};for(const x of m)x.type==="function"&&(c[x.function.name||x.function.function.name]=x.function);const f="tools"in t?m.map(x=>x.type==="function"?{type:"function",function:{name:x.function.name||x.function.function.name,parameters:x.function.parameters,description:x.function.description,strict:x.function.strict}}:x):void 0;for(const x of t.messages)this._addMessage(x,!1);for(let x=0;x<d;++x){const p=(g=(await this._createChatCompletion(e,{...l,tool_choice:a,tools:f,messages:[...this.messages]},n)).choices[0])==null?void 0:g.message;if(!p)throw new v("missing message in ChatCompletion response");if(!((y=p.tool_calls)!=null&&y.length))return;for(const S of p.tool_calls){if(S.type!=="function")continue;const b=S.id,{name:j,arguments:R}=S.function,P=c[j];if(P){if(u&&u!==j){const k=`Invalid tool_call: ${JSON.stringify(j)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:r,tool_call_id:b,content:k});continue}}else{const k=`Invalid tool_call: ${JSON.stringify(j)}. Available options are: ${Object.keys(c).map(xe=>JSON.stringify(xe)).join(", ")}. Please try again`;this._addMessage({role:r,tool_call_id:b,content:k});continue}let D;try{D=cs(P)?await P.parse(R):R}catch(k){const xe=k instanceof Error?k.message:String(k);this._addMessage({role:r,tool_call_id:b,content:xe});continue}const I=await P.function(D,this),T=V(this,J,"m",sn).call(this,I);if(this._addMessage({role:r,tool_call_id:b,content:T}),u)return}}}}J=new WeakSet,Zt=function(){return V(this,J,"m",pt).call(this).content??null},pt=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(Re(t)){const{function_call:n,...r}=t,a={...r,content:t.content??null,refusal:t.refusal??null};return n&&(a.function_call=n),a}}throw new v("stream ended without producing a ChatCompletionMessage with role=assistant")},en=function(){var e,t;for(let n=this.messages.length-1;n>=0;n--){const r=this.messages[n];if(Re(r)&&(r!=null&&r.function_call))return r.function_call;if(Re(r)&&((e=r==null?void 0:r.tool_calls)!=null&&e.length))return(t=r.tool_calls.at(-1))==null?void 0:t.function}},tn=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(dr(t)&&t.content!=null||hr(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var r;return n.role==="assistant"&&((r=n.tool_calls)==null?void 0:r.some(a=>a.type==="function"&&a.id===t.tool_call_id))}))return t.content}},nn=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},mr=function(e){if(e.n!=null&&e.n>1)throw new v("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},sn=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Ue extends gr{static runFunctions(e,t,n){const r=new Ue,a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run(()=>r._runFunctions(e,t,a)),r}static runTools(e,t,n){const r=new Ue,a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(e,t,a)),r}_addMessage(e,t=!0){super._addMessage(e,t),Re(e)&&e.content&&this._emit("content",e.content)}}const pr=1,yr=2,wr=4,xr=8,_r=16,br=32,vr=64,Sr=128,Cr=256,Ar=Sr|Cr,Pr=_r|br|Ar|vr,Rr=pr|yr|Pr,jr=wr|xr,xi=Rr|jr,U={STR:pr,NUM:yr,ARR:wr,OBJ:xr,NULL:_r,BOOL:br,NAN:vr,INFINITY:Sr,MINUS_INFINITY:Cr,INF:Ar,SPECIAL:Pr,ATOM:Rr,COLLECTION:jr,ALL:xi};class _i extends Error{}class bi extends Error{}function vi(s,e=U.ALL){if(typeof s!="string")throw new TypeError(`expecting str, got ${typeof s}`);if(!s.trim())throw new Error(`${s} is empty`);return Si(s.trim(),e)}const Si=(s,e)=>{const t=s.length;let n=0;const r=f=>{throw new _i(`${f} at position ${n}`)},a=f=>{throw new bi(`${f} at position ${n}`)},i=()=>(c(),n>=t&&r("Unexpected end of input"),s[n]==='"'?l():s[n]==="{"?u():s[n]==="["?d():s.substring(n,n+4)==="null"||U.NULL&e&&t-n<4&&"null".startsWith(s.substring(n))?(n+=4,null):s.substring(n,n+4)==="true"||U.BOOL&e&&t-n<4&&"true".startsWith(s.substring(n))?(n+=4,!0):s.substring(n,n+5)==="false"||U.BOOL&e&&t-n<5&&"false".startsWith(s.substring(n))?(n+=5,!1):s.substring(n,n+8)==="Infinity"||U.INFINITY&e&&t-n<8&&"Infinity".startsWith(s.substring(n))?(n+=8,1/0):s.substring(n,n+9)==="-Infinity"||U.MINUS_INFINITY&e&&1<t-n&&t-n<9&&"-Infinity".startsWith(s.substring(n))?(n+=9,-1/0):s.substring(n,n+3)==="NaN"||U.NAN&e&&t-n<3&&"NaN".startsWith(s.substring(n))?(n+=3,NaN):m()),l=()=>{const f=n;let h=!1;for(n++;n<t&&(s[n]!=='"'||h&&s[n-1]==="\\");)h=s[n]==="\\"?!h:!1,n++;if(s.charAt(n)=='"')try{return JSON.parse(s.substring(f,++n-Number(h)))}catch(g){a(String(g))}else if(U.STR&e)try{return JSON.parse(s.substring(f,n-Number(h))+'"')}catch{return JSON.parse(s.substring(f,s.lastIndexOf("\\"))+'"')}r("Unterminated string literal")},u=()=>{n++,c();const f={};try{for(;s[n]!=="}";){if(c(),n>=t&&U.OBJ&e)return f;const h=l();c(),n++;try{const g=i();Object.defineProperty(f,h,{value:g,writable:!0,enumerable:!0,configurable:!0})}catch(g){if(U.OBJ&e)return f;throw g}c(),s[n]===","&&n++}}catch{if(U.OBJ&e)return f;r("Expected '}' at end of object")}return n++,f},d=()=>{n++;const f=[];try{for(;s[n]!=="]";)f.push(i()),c(),s[n]===","&&n++}catch{if(U.ARR&e)return f;r("Expected ']' at end of array")}return n++,f},m=()=>{if(n===0){s==="-"&&U.NUM&e&&r("Not sure what '-' is");try{return JSON.parse(s)}catch(h){if(U.NUM&e)try{return s[s.length-1]==="."?JSON.parse(s.substring(0,s.lastIndexOf("."))):JSON.parse(s.substring(0,s.lastIndexOf("e")))}catch{}a(String(h))}}const f=n;for(s[n]==="-"&&n++;s[n]&&!",]}".includes(s[n]);)n++;n==t&&!(U.NUM&e)&&r("Unterminated number literal");try{return JSON.parse(s.substring(f,n))}catch{s.substring(f,n)==="-"&&U.NUM&e&&r("Not sure what '-' is");try{return JSON.parse(s.substring(f,s.lastIndexOf("e")))}catch(g){a(String(g))}}},c=()=>{for(;n<t&&` 
\r	`.includes(s[n]);)n++};return i()},ds=s=>vi(s,U.ALL^U.NUM);var _e=globalThis&&globalThis.__classPrivateFieldSet||function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},E=globalThis&&globalThis.__classPrivateFieldGet||function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},F,re,be,ie,Ut,tt,Wt,Ht,Jt,nt,Vt,hs;class We extends gr{constructor(e){super(),F.add(this),re.set(this,void 0),be.set(this,void 0),ie.set(this,void 0),_e(this,re,e,"f"),_e(this,be,[],"f")}get currentChatCompletionSnapshot(){return E(this,ie,"f")}static fromReadableStream(e){const t=new We(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,n){const r=new We(t);return r._run(()=>r._runChatCompletion(e,{...t,stream:!0},{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createChatCompletion(e,t,n){var i;super._createChatCompletion;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),E(this,F,"m",Ut).call(this);const a=await e.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const l of a)E(this,F,"m",Wt).call(this,l);if((i=a.controller.signal)!=null&&i.aborted)throw new K;return this._addChatCompletion(E(this,F,"m",nt).call(this))}async _fromReadableStream(e,t){var i;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),E(this,F,"m",Ut).call(this),this._connected();const r=se.fromReadableStream(e,this.controller);let a;for await(const l of r)a&&a!==l.id&&this._addChatCompletion(E(this,F,"m",nt).call(this)),E(this,F,"m",Wt).call(this,l),a=l.id;if((i=r.controller.signal)!=null&&i.aborted)throw new K;return this._addChatCompletion(E(this,F,"m",nt).call(this))}[(re=new WeakMap,be=new WeakMap,ie=new WeakMap,F=new WeakSet,Ut=function(){this.ended||_e(this,ie,void 0,"f")},tt=function(t){let n=E(this,be,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},E(this,be,"f")[t.index]=n,n)},Wt=function(t){var r,a,i,l,u,d,m,c,f,h,g,y,x,N,p;if(this.ended)return;const n=E(this,F,"m",hs).call(this,t);this._emit("chunk",t,n);for(const S of t.choices){const b=n.choices[S.index];S.delta.content!=null&&((r=b.message)==null?void 0:r.role)==="assistant"&&((a=b.message)!=null&&a.content)&&(this._emit("content",S.delta.content,b.message.content),this._emit("content.delta",{delta:S.delta.content,snapshot:b.message.content,parsed:b.message.parsed})),S.delta.refusal!=null&&((i=b.message)==null?void 0:i.role)==="assistant"&&((l=b.message)!=null&&l.refusal)&&this._emit("refusal.delta",{delta:S.delta.refusal,snapshot:b.message.refusal}),((u=S.logprobs)==null?void 0:u.content)!=null&&((d=b.message)==null?void 0:d.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(m=S.logprobs)==null?void 0:m.content,snapshot:((c=b.logprobs)==null?void 0:c.content)??[]}),((f=S.logprobs)==null?void 0:f.refusal)!=null&&((h=b.message)==null?void 0:h.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(g=S.logprobs)==null?void 0:g.refusal,snapshot:((y=b.logprobs)==null?void 0:y.refusal)??[]});const j=E(this,F,"m",tt).call(this,b);b.finish_reason&&(E(this,F,"m",Jt).call(this,b),j.current_tool_call_index!=null&&E(this,F,"m",Ht).call(this,b,j.current_tool_call_index));for(const R of S.delta.tool_calls??[])j.current_tool_call_index!==R.index&&(E(this,F,"m",Jt).call(this,b),j.current_tool_call_index!=null&&E(this,F,"m",Ht).call(this,b,j.current_tool_call_index)),j.current_tool_call_index=R.index;for(const R of S.delta.tool_calls??[]){const P=(x=b.message.tool_calls)==null?void 0:x[R.index];P!=null&&P.type&&((P==null?void 0:P.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(N=P.function)==null?void 0:N.name,index:R.index,arguments:P.function.arguments,parsed_arguments:P.function.parsed_arguments,arguments_delta:((p=R.function)==null?void 0:p.arguments)??""}):(P==null||P.type,void 0))}}},Ht=function(t,n){var i,l,u;if(E(this,F,"m",tt).call(this,t).done_tool_calls.has(n))return;const a=(i=t.message.tool_calls)==null?void 0:i[n];if(!a)throw new Error("no tool call snapshot");if(!a.type)throw new Error("tool call snapshot missing `type`");if(a.type==="function"){const d=(u=(l=E(this,re,"f"))==null?void 0:l.tools)==null?void 0:u.find(m=>m.type==="function"&&m.function.name===a.function.name);this._emit("tool_calls.function.arguments.done",{name:a.function.name,index:n,arguments:a.function.arguments,parsed_arguments:Ve(d)?d.$parseRaw(a.function.arguments):d!=null&&d.function.strict?JSON.parse(a.function.arguments):null})}else a.type},Jt=function(t){var r,a;const n=E(this,F,"m",tt).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const i=E(this,F,"m",Vt).call(this);this._emit("content.done",{content:t.message.content,parsed:i?i.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(r=t.logprobs)!=null&&r.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(a=t.logprobs)!=null&&a.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},nt=function(){if(this.ended)throw new v("stream has ended, this shouldn't happen");const t=E(this,ie,"f");if(!t)throw new v("request ended without sending any chunks");return _e(this,ie,void 0,"f"),_e(this,be,[],"f"),Ci(t,E(this,re,"f"))},Vt=function(){var n;const t=(n=E(this,re,"f"))==null?void 0:n.response_format;return hn(t)?t:null},hs=function(t){var n,r,a,i;let l=E(this,ie,"f");const{choices:u,...d}=t;l?Object.assign(l,d):l=_e(this,ie,{...d,choices:[]},"f");for(const{delta:m,finish_reason:c,index:f,logprobs:h=null,...g}of t.choices){let y=l.choices[f];if(y||(y=l.choices[f]={finish_reason:c,index:f,message:{},logprobs:h,...g}),h)if(!y.logprobs)y.logprobs=Object.assign({},h);else{const{content:R,refusal:P,...D}=h;Object.assign(y.logprobs,D),R&&((n=y.logprobs).content??(n.content=[]),y.logprobs.content.push(...R)),P&&((r=y.logprobs).refusal??(r.refusal=[]),y.logprobs.refusal.push(...P))}if(c&&(y.finish_reason=c,E(this,re,"f")&&fr(E(this,re,"f")))){if(c==="length")throw new qs;if(c==="content_filter")throw new zs}if(Object.assign(y,g),!m)continue;const{content:x,refusal:N,function_call:p,role:S,tool_calls:b,...j}=m;if(Object.assign(y.message,j),N&&(y.message.refusal=(y.message.refusal||"")+N),S&&(y.message.role=S),p&&(y.message.function_call?(p.name&&(y.message.function_call.name=p.name),p.arguments&&((a=y.message.function_call).arguments??(a.arguments=""),y.message.function_call.arguments+=p.arguments)):y.message.function_call=p),x&&(y.message.content=(y.message.content||"")+x,!y.message.refusal&&E(this,F,"m",Vt).call(this)&&(y.message.parsed=ds(y.message.content))),b){y.message.tool_calls||(y.message.tool_calls=[]);for(const{index:R,id:P,type:D,function:I,...T}of b){const k=(i=y.message.tool_calls)[R]??(i[R]={});Object.assign(k,T),P&&(k.id=P),D&&(k.type=D),I&&(k.function??(k.function={name:I.name??"",arguments:""})),I!=null&&I.name&&(k.function.name=I.name),I!=null&&I.arguments&&(k.function.arguments+=I.arguments,yi(E(this,re,"f"),k)&&(k.function.parsed_arguments=ds(k.function.arguments)))}}}return l},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("chunk",r=>{const a=t.shift();a?a.resolve(r):e.push(r)}),this.on("end",()=>{n=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),this.on("error",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,i)=>t.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new se(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Ci(s,e){const{id:t,choices:n,created:r,model:a,system_fingerprint:i,...l}=s,u={...l,id:t,choices:n.map(({message:d,finish_reason:m,index:c,logprobs:f,...h})=>{if(!m)throw new v(`missing finish_reason for choice ${c}`);const{content:g=null,function_call:y,tool_calls:x,...N}=d,p=d.role;if(!p)throw new v(`missing role for choice ${c}`);if(y){const{arguments:S,name:b}=y;if(S==null)throw new v(`missing function_call.arguments for choice ${c}`);if(!b)throw new v(`missing function_call.name for choice ${c}`);return{...h,message:{content:g,function_call:{arguments:S,name:b},role:p,refusal:d.refusal??null},finish_reason:m,index:c,logprobs:f}}return x?{...h,index:c,finish_reason:m,logprobs:f,message:{...N,role:p,content:g,refusal:d.refusal??null,tool_calls:x.map((S,b)=>{const{function:j,type:R,id:P,...D}=S,{arguments:I,name:T,...k}=j||{};if(P==null)throw new v(`missing choices[${c}].tool_calls[${b}].id
${st(s)}`);if(R==null)throw new v(`missing choices[${c}].tool_calls[${b}].type
${st(s)}`);if(T==null)throw new v(`missing choices[${c}].tool_calls[${b}].function.name
${st(s)}`);if(I==null)throw new v(`missing choices[${c}].tool_calls[${b}].function.arguments
${st(s)}`);return{...D,id:P,type:R,function:{...k,name:T,arguments:I}}})}}:{...h,message:{...N,content:g,role:p,refusal:d.refusal??null},finish_reason:m,index:c,logprobs:f}}),created:r,model:a,object:"chat.completion",...i?{system_fingerprint:i}:{}};return mi(u,e)}function st(s){return JSON.stringify(s)}class je extends We{static fromReadableStream(e){const t=new je(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,n){const r=new je(null),a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run(()=>r._runFunctions(e,t,a)),r}static runTools(e,t,n){const r=new je(t),a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(e,t,a)),r}}let Nr=class extends C{parse(e,t){return wi(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>fn(n,e))}runFunctions(e,t){return e.stream?je.runFunctions(this._client,e,t):Ue.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?je.runTools(this._client,e,t):Ue.runTools(this._client,e,t)}stream(e,t){return We.createChatCompletion(this._client,e,t)}},rn=class extends C{constructor(){super(...arguments),this.completions=new Nr(this._client)}};(function(s){s.Completions=Nr})(rn||(rn={}));class Er extends C{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class kr extends C{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Rt extends C{constructor(){super(...arguments),this.sessions=new Er(this._client),this.transcriptionSessions=new kr(this._client)}}Rt.Sessions=Er;Rt.TranscriptionSessions=kr;class mn extends C{create(e,t,n){return this._client.post(`/threads/${e}/messages`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/messages/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e,t={},n){return O(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,gn,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class gn extends B{}mn.MessagesPage=gn;class pn extends C{retrieve(e,t,n,r={},a){return O(r)?this.retrieve(e,t,n,{},r):this._client.get(`/threads/${e}/runs/${t}/steps/${n}`,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(e,t,n={},r){return O(n)?this.list(e,t,{},n):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,yn,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class yn extends B{}pn.RunStepsPage=yn;let Xe=class extends C{constructor(){super(...arguments),this.steps=new pn(this._client)}create(e,t,n){const{include:r,...a}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:r},body:a,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:t.stream??!1})}retrieve(e,t,n){return this._client.get(`/threads/${e}/runs/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e,t={},n){return O(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,wn,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,t,n){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}createAndStream(e,t,n){return Z.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){const r={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:a,response:i}=await this.retrieve(e,t,{...n,headers:{...n==null?void 0:n.headers,...r}}).withResponse();switch(a.status){case"queued":case"in_progress":case"cancelling":let l=5e3;if(n!=null&&n.pollIntervalMs)l=n.pollIntervalMs;else{const u=i.headers.get("openai-poll-after-ms");if(u){const d=parseInt(u);isNaN(d)||(l=d)}}await He(l);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return a}}}stream(e,t,n){return Z.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(e,t,n,r){const a=await this.submitToolOutputs(e,t,n,r);return await this.poll(e,a.id,r)}submitToolOutputsStream(e,t,n,r){return Z.createToolAssistantStream(e,t,this._client.beta.threads.runs,n,r)}};class wn extends B{}Xe.RunsPage=wn;Xe.Steps=pn;Xe.RunStepsPage=yn;class Ne extends C{constructor(){super(...arguments),this.runs=new Xe(this._client),this.messages=new mn(this._client)}create(e={},t){return O(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/threads/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const n=await this.createAndRun(e,t);return await this.runs.poll(n.thread_id,n.id,t)}createAndRunStream(e,t){return Z.createThreadAssistantStream(e,this._client.beta.threads,t)}}Ne.Runs=Xe;Ne.RunsPage=wn;Ne.Messages=mn;Ne.MessagesPage=gn;class Ee extends C{constructor(){super(...arguments),this.realtime=new Rt(this._client),this.chat=new rn(this._client),this.assistants=new un(this._client),this.threads=new Ne(this._client)}}Ee.Realtime=Rt;Ee.Assistants=un;Ee.AssistantsPage=dn;Ee.Threads=Ne;class Ir extends C{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class $r extends C{retrieve(e,t,n){return this._client.get(`/containers/${e}/files/${t}/content`,{...n,headers:{Accept:"application/binary",...n==null?void 0:n.headers},__binaryResponse:!0})}}let jt=class extends C{constructor(){super(...arguments),this.content=new $r(this._client)}create(e,t,n){return this._client.post(`/containers/${e}/files`,we({body:t,...n}))}retrieve(e,t,n){return this._client.get(`/containers/${e}/files/${t}`,n)}list(e,t={},n){return O(t)?this.list(e,{},t):this._client.getAPIList(`/containers/${e}/files`,xn,{query:t,...n})}del(e,t,n){return this._client.delete(`/containers/${e}/files/${t}`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}};class xn extends B{}jt.FileListResponsesPage=xn;jt.Content=$r;class Ge extends C{constructor(){super(...arguments),this.files=new jt(this._client)}create(e,t){return this._client.post("/containers",{body:e,...t})}retrieve(e,t){return this._client.get(`/containers/${e}`,t)}list(e={},t){return O(e)?this.list({},e):this._client.getAPIList("/containers",_n,{query:e,...t})}del(e,t){return this._client.delete(`/containers/${e}`,{...t,headers:{Accept:"*/*",...t==null?void 0:t.headers}})}}class _n extends B{}Ge.ContainerListResponsesPage=_n;Ge.Files=jt;Ge.FileListResponsesPage=xn;class Mr extends C{create(e,t){const n=!!e.encoding_format;let r=n?e.encoding_format:"base64";n&&de("Request","User defined encoding_format:",e.encoding_format);const a=this._client.post("/embeddings",{body:{...e,encoding_format:r},...t});return n?a:(de("response","Decoding base64 embeddings to float32 array"),a._thenUnwrap(i=>(i&&i.data&&i.data.forEach(l=>{const u=l.embedding;l.embedding=hi(u)}),i)))}}class bn extends C{retrieve(e,t,n,r){return this._client.get(`/evals/${e}/runs/${t}/output_items/${n}`,r)}list(e,t,n={},r){return O(n)?this.list(e,t,{},n):this._client.getAPIList(`/evals/${e}/runs/${t}/output_items`,vn,{query:n,...r})}}class vn extends B{}bn.OutputItemListResponsesPage=vn;class qe extends C{constructor(){super(...arguments),this.outputItems=new bn(this._client)}create(e,t,n){return this._client.post(`/evals/${e}/runs`,{body:t,...n})}retrieve(e,t,n){return this._client.get(`/evals/${e}/runs/${t}`,n)}list(e,t={},n){return O(t)?this.list(e,{},t):this._client.getAPIList(`/evals/${e}/runs`,Sn,{query:t,...n})}del(e,t,n){return this._client.delete(`/evals/${e}/runs/${t}`,n)}cancel(e,t,n){return this._client.post(`/evals/${e}/runs/${t}`,n)}}class Sn extends B{}qe.RunListResponsesPage=Sn;qe.OutputItems=bn;qe.OutputItemListResponsesPage=vn;class ze extends C{constructor(){super(...arguments),this.runs=new qe(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get(`/evals/${e}`,t)}update(e,t,n){return this._client.post(`/evals/${e}`,{body:t,...n})}list(e={},t){return O(e)?this.list({},e):this._client.getAPIList("/evals",Cn,{query:e,...t})}del(e,t){return this._client.delete(`/evals/${e}`,t)}}class Cn extends B{}ze.EvalListResponsesPage=Cn;ze.Runs=qe;ze.RunListResponsesPage=Sn;let An=class extends C{create(e,t){return this._client.post("/files",we({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return O(e)?this.list({},e):this._client.getAPIList("/files",Pn,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t==null?void 0:t.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=30*60*1e3}={}){const r=new Set(["processed","error","deleted"]),a=Date.now();let i=await this.retrieve(e);for(;!i.status||!r.has(i.status);)if(await He(t),i=await this.retrieve(e),Date.now()-a>n)throw new an({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return i}};class Pn extends B{}An.FileObjectsPage=Pn;class Or extends C{}let Tr=class extends C{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...t})}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...t})}};class Rn extends C{constructor(){super(...arguments),this.graders=new Tr(this._client)}}Rn.Graders=Tr;class jn extends C{create(e,t,n){return this._client.getAPIList(`/fine_tuning/checkpoints/${e}/permissions`,Nn,{body:t,method:"post",...n})}retrieve(e,t={},n){return O(t)?this.retrieve(e,{},t):this._client.get(`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...n})}del(e,t,n){return this._client.delete(`/fine_tuning/checkpoints/${e}/permissions/${t}`,n)}}class Nn extends St{}jn.PermissionCreateResponsesPage=Nn;let Nt=class extends C{constructor(){super(...arguments),this.permissions=new jn(this._client)}};Nt.Permissions=jn;Nt.PermissionCreateResponsesPage=Nn;class En extends C{list(e,t={},n){return O(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,kn,{query:t,...n})}}class kn extends B{}En.FineTuningJobCheckpointsPage=kn;class ke extends C{constructor(){super(...arguments),this.checkpoints=new En(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return O(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",In,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){return O(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,$n,{query:t,...n})}pause(e,t){return this._client.post(`/fine_tuning/jobs/${e}/pause`,t)}resume(e,t){return this._client.post(`/fine_tuning/jobs/${e}/resume`,t)}}class In extends B{}class $n extends B{}ke.FineTuningJobsPage=In;ke.FineTuningJobEventsPage=$n;ke.Checkpoints=En;ke.FineTuningJobCheckpointsPage=kn;class he extends C{constructor(){super(...arguments),this.methods=new Or(this._client),this.jobs=new ke(this._client),this.checkpoints=new Nt(this._client),this.alpha=new Rn(this._client)}}he.Methods=Or;he.Jobs=ke;he.FineTuningJobsPage=In;he.FineTuningJobEventsPage=$n;he.Checkpoints=Nt;he.Alpha=Rn;class Fr extends C{}class Mn extends C{constructor(){super(...arguments),this.graderModels=new Fr(this._client)}}Mn.GraderModels=Fr;class Lr extends C{createVariation(e,t){return this._client.post("/images/variations",we({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",we({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class On extends C{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",Tn,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class Tn extends St{}On.ModelsPage=Tn;class Br extends C{create(e,t){return this._client.post("/moderations",{body:e,...t})}}function Ai(s,e){return!e||!Ri(e)?{...s,output_parsed:null,output:s.output.map(t=>t.type==="function_call"?{...t,parsed_arguments:null}:t.type==="message"?{...t,content:t.content.map(n=>({...n,parsed:null}))}:t)}:Dr(s,e)}function Dr(s,e){const t=s.output.map(r=>{if(r.type==="function_call")return{...r,parsed_arguments:Ei(e,r)};if(r.type==="message"){const a=r.content.map(i=>i.type==="output_text"?{...i,parsed:Pi(e,i.text)}:i);return{...r,content:a}}return r}),n=Object.assign({},s,{output:t});return Object.getOwnPropertyDescriptor(s,"output_text")||Ur(n),Object.defineProperty(n,"output_parsed",{enumerable:!0,get(){for(const r of n.output)if(r.type==="message"){for(const a of r.content)if(a.type==="output_text"&&a.parsed!==null)return a.parsed}return null}}),n}function Pi(s,e){var t,n,r,a;return((n=(t=s.text)==null?void 0:t.format)==null?void 0:n.type)!=="json_schema"?null:"$parseRaw"in((r=s.text)==null?void 0:r.format)?((a=s.text)==null?void 0:a.format).$parseRaw(e):JSON.parse(e)}function Ri(s){var e;return!!hn((e=s.text)==null?void 0:e.format)}function ji(s){return(s==null?void 0:s.$brand)==="auto-parseable-tool"}function Ni(s,e){return s.find(t=>t.type==="function"&&t.name===e)}function Ei(s,e){const t=Ni(s.tools??[],e.name);return{...e,...e,parsed_arguments:ji(t)?t.$parseRaw(e.arguments):t!=null&&t.strict?JSON.parse(e.arguments):null}}function Ur(s){const e=[];for(const t of s.output)if(t.type==="message")for(const n of t.content)n.type==="output_text"&&e.push(n.text);s.output_text=e.join("")}class Wr extends C{list(e,t={},n){return O(t)?this.list(e,{},t):this._client.getAPIList(`/responses/${e}/input_items`,Ii,{query:t,...n})}}var ve=globalThis&&globalThis.__classPrivateFieldSet||function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},oe=globalThis&&globalThis.__classPrivateFieldGet||function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},Se,rt,le,at,fs,ms,gs,ps;class Fn extends cn{constructor(e){super(),Se.add(this),rt.set(this,void 0),le.set(this,void 0),at.set(this,void 0),ve(this,rt,e,"f")}static createResponse(e,t,n){const r=new Fn(t);return r._run(()=>r._createOrRetrieveResponse(e,t,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createOrRetrieveResponse(e,t,n){var l;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),oe(this,Se,"m",fs).call(this);let a,i=null;"response_id"in t?(a=await e.responses.retrieve(t.response_id,{stream:!0},{...n,signal:this.controller.signal,stream:!0}),i=t.starting_after??null):a=await e.responses.create({...t,stream:!0},{...n,signal:this.controller.signal}),this._connected();for await(const u of a)oe(this,Se,"m",ms).call(this,u,i);if((l=a.controller.signal)!=null&&l.aborted)throw new K;return oe(this,Se,"m",gs).call(this)}[(rt=new WeakMap,le=new WeakMap,at=new WeakMap,Se=new WeakSet,fs=function(){this.ended||ve(this,le,void 0,"f")},ms=function(t,n){if(this.ended)return;const r=(i,l)=>{(n==null||l.sequence_number>n)&&this._emit(i,l)},a=oe(this,Se,"m",ps).call(this,t);switch(r("event",t),t.type){case"response.output_text.delta":{const i=a.output[t.output_index];if(!i)throw new v(`missing output at index ${t.output_index}`);if(i.type==="message"){const l=i.content[t.content_index];if(!l)throw new v(`missing content at index ${t.content_index}`);if(l.type!=="output_text")throw new v(`expected content to be 'output_text', got ${l.type}`);r("response.output_text.delta",{...t,snapshot:l.text})}break}case"response.function_call_arguments.delta":{const i=a.output[t.output_index];if(!i)throw new v(`missing output at index ${t.output_index}`);i.type==="function_call"&&r("response.function_call_arguments.delta",{...t,snapshot:i.arguments});break}default:r(t.type,t);break}},gs=function(){if(this.ended)throw new v("stream has ended, this shouldn't happen");const t=oe(this,le,"f");if(!t)throw new v("request ended without sending any events");ve(this,le,void 0,"f");const n=ki(t,oe(this,rt,"f"));return ve(this,at,n,"f"),n},ps=function(t){let n=oe(this,le,"f");if(!n){if(t.type!=="response.created")throw new v(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return n=ve(this,le,t.response,"f"),n}switch(t.type){case"response.output_item.added":{n.output.push(t.item);break}case"response.content_part.added":{const r=n.output[t.output_index];if(!r)throw new v(`missing output at index ${t.output_index}`);r.type==="message"&&r.content.push(t.part);break}case"response.output_text.delta":{const r=n.output[t.output_index];if(!r)throw new v(`missing output at index ${t.output_index}`);if(r.type==="message"){const a=r.content[t.content_index];if(!a)throw new v(`missing content at index ${t.content_index}`);if(a.type!=="output_text")throw new v(`expected content to be 'output_text', got ${a.type}`);a.text+=t.delta}break}case"response.function_call_arguments.delta":{const r=n.output[t.output_index];if(!r)throw new v(`missing output at index ${t.output_index}`);r.type==="function_call"&&(r.arguments+=t.delta);break}case"response.completed":{ve(this,le,t.response,"f");break}}return n},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",r=>{const a=t.shift();a?a.resolve(r):e.push(r)}),this.on("end",()=>{n=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),this.on("error",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,i)=>t.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=oe(this,at,"f");if(!e)throw new v("stream ended without producing a ChatCompletion");return e}}function ki(s,e){return Ai(s,e)}class Ln extends C{constructor(){super(...arguments),this.inputItems=new Wr(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap(n=>("object"in n&&n.object==="response"&&Ur(n),n))}retrieve(e,t={},n){return this._client.get(`/responses/${e}`,{query:t,...n,stream:(t==null?void 0:t.stream)??!1})}del(e,t){return this._client.delete(`/responses/${e}`,{...t,headers:{Accept:"*/*",...t==null?void 0:t.headers}})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(n=>Dr(n,e))}stream(e,t){return Fn.createResponse(this._client,e,t)}cancel(e,t){return this._client.post(`/responses/${e}/cancel`,{...t,headers:{Accept:"*/*",...t==null?void 0:t.headers}})}}class Ii extends B{}Ln.InputItems=Wr;class Hr extends C{create(e,t,n){return this._client.post(`/uploads/${e}/parts`,we({body:t,...n}))}}class Bn extends C{constructor(){super(...arguments),this.parts=new Hr(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,n){return this._client.post(`/uploads/${e}/complete`,{body:t,...n})}}Bn.Parts=Hr;const $i=async s=>{const e=await Promise.allSettled(s),t=e.filter(r=>r.status==="rejected");if(t.length){for(const r of t)console.error(r.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const n=[];for(const r of e)r.status==="fulfilled"&&n.push(r.value);return n};class Et extends C{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,t,n,r){return this._client.post(`/vector_stores/${e}/files/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e,t={},n){return O(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,kt,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}async poll(e,t,n){const r={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const a=await this.retrieve(e,t,{...n,headers:r}).withResponse(),i=a.data;switch(i.status){case"in_progress":let l=5e3;if(n!=null&&n.pollIntervalMs)l=n.pollIntervalMs;else{const u=a.response.headers.get("openai-poll-after-ms");if(u){const d=parseInt(u);isNaN(d)||(l=d)}}await He(l);break;case"failed":case"completed":return i}}}async upload(e,t,n){const r=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:r.id},n)}async uploadAndPoll(e,t,n){const r=await this.upload(e,t,n);return await this.poll(e,r.id,n)}content(e,t,n){return this._client.getAPIList(`/vector_stores/${e}/files/${t}/content`,Dn,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class kt extends B{}class Dn extends St{}Et.VectorStoreFilesPage=kt;Et.FileContentResponsesPage=Dn;class Jr extends C{create(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t);return await this.poll(e,r.id,n)}listFiles(e,t,n={},r){return O(n)?this.listFiles(e,t,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,kt,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async poll(e,t,n){const r={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:a,response:i}=await this.retrieve(e,t,{...n,headers:r}).withResponse();switch(a.status){case"in_progress":let l=5e3;if(n!=null&&n.pollIntervalMs)l=n.pollIntervalMs;else{const u=i.headers.get("openai-poll-after-ms");if(u){const d=parseInt(u);isNaN(d)||(l=d)}}await He(l);break;case"failed":case"cancelled":case"completed":return a}}}async uploadAndPoll(e,{files:t,fileIds:n=[]},r){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const a=(r==null?void 0:r.maxConcurrency)??5,i=Math.min(a,t.length),l=this._client,u=t.values(),d=[...n];async function m(f){for(let h of f){const g=await l.files.create({file:h,purpose:"assistants"},r);d.push(g.id)}}const c=Array(i).fill(u).map(m);return await $i(c),await this.createAndPoll(e,{file_ids:d})}}class fe extends C{constructor(){super(...arguments),this.files=new Et(this._client),this.fileBatches=new Jr(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/vector_stores/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},t){return O(e)?this.list({},e):this._client.getAPIList("/vector_stores",Un,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}search(e,t,n){return this._client.getAPIList(`/vector_stores/${e}/search`,Wn,{body:t,method:"post",...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Un extends B{}class Wn extends St{}fe.VectorStoresPage=Un;fe.VectorStoreSearchResponsesPage=Wn;fe.Files=Et;fe.VectorStoreFilesPage=kt;fe.FileContentResponsesPage=Dn;fe.FileBatches=Jr;var Vr;class A extends ei{constructor({baseURL:e=Ze("OPENAI_BASE_URL"),apiKey:t=Ze("OPENAI_API_KEY"),organization:n=Ze("OPENAI_ORG_ID")??null,project:r=Ze("OPENAI_PROJECT_ID")??null,...a}={}){if(t===void 0)throw new v("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const i={apiKey:t,organization:n,project:r,...a,baseURL:e||"https://api.openai.com/v1"};if(!i.dangerouslyAllowBrowser&&ui())throw new v(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:i.baseURL,timeout:i.timeout??6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new Ir(this),this.chat=new Pt(this),this.embeddings=new Mr(this),this.files=new An(this),this.images=new Lr(this),this.audio=new Je(this),this.moderations=new Br(this),this.models=new On(this),this.fineTuning=new he(this),this.graders=new Mn(this),this.vectorStores=new fe(this),this.beta=new Ee(this),this.batches=new on(this),this.uploads=new Bn(this),this.responses=new Ln(this),this.evals=new ze(this),this.containers=new Ge(this),this._options=i,this.apiKey=t,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return Ta(e,{arrayFormat:"brackets"})}}Vr=A;A.OpenAI=Vr;A.DEFAULT_TIMEOUT=6e5;A.OpenAIError=v;A.APIError=H;A.APIConnectionError=xt;A.APIConnectionTimeoutError=an;A.APIUserAbortError=K;A.NotFoundError=Hs;A.ConflictError=Js;A.RateLimitError=Xs;A.BadRequestError=Ds;A.AuthenticationError=Us;A.InternalServerError=Gs;A.PermissionDeniedError=Ws;A.UnprocessableEntityError=Vs;A.toFile=Zs;A.fileFromPath=Fs;A.Completions=Ir;A.Chat=Pt;A.ChatCompletionsPage=At;A.Embeddings=Mr;A.Files=An;A.FileObjectsPage=Pn;A.Images=Lr;A.Audio=Je;A.Moderations=Br;A.Models=On;A.ModelsPage=Tn;A.FineTuning=he;A.Graders=Mn;A.VectorStores=fe;A.VectorStoresPage=Un;A.VectorStoreSearchResponsesPage=Wn;A.Beta=Ee;A.Batches=on;A.BatchesPage=ln;A.Uploads=Bn;A.Responses=Ln;A.Evals=ze;A.EvalListResponsesPage=Cn;A.Containers=Ge;A.ContainerListResponsesPage=_n;const Mi=A,Xr=w.createContext();function Oi({children:s}){const[e,t]=w.useState([]),[n,r]=w.useState("normal"),[a,i]=w.useState(null),[l,u]=w.useState(""),{sendNotification:d}=wt(),m=w.useRef(null),c=w.useCallback(N=>{u(N),m.current=new Mi({apiKey:N,dangerouslyAllowBrowser:!0})},[]);!m.current&&l&&c(l);const f=w.useRef(e);f.current=e;const h=w.useCallback(N=>`You are Lyo, an emotionally intelligent AI companion focused on emotional clarity and personal growth. You have the following capabilities:

1. LANGUAGE + CULTURAL ADAPTABILITY
- Automatically detect and mirror the user's language, slang, and emotional tone
- If the user mixes languages (e.g., Taglish, Spanglish, Franglais), match that flow naturally
- Support multiple languages and adapt to the user's style

2. PROBLEM SOLVER MODE
When presented with analytical problems (math, physics, logic, etc.):
- Detect the domain automatically and solve step-by-step
- Format solutions clearly using markdown
- Present steps in a clear, organized way:
  Problem: [Restate the question]
  Step 1: [Clear explanation]
  Step 2: [Clear explanation]
  Final Answer: [Result]
- If the user seems tired or stressed:
  - Give the answer first
  - Then ask if they want to see the detailed steps
- If they want to learn:
  - Guide them through the logic
  - Explain concepts clearly
  - Use analogies when helpful
- Keep explanations grounded and conversational

Remember to:
- Match the user's tone (serious, casual, etc.)
- Mirror their communication style
- Adapt to their cognitive state
- Stay grounded and authentic in responses
- Format mathematical content professionally using markdown
- Provide direct answers to questions
- Be helpful and concise

Current Mode: ${{normal:"Maintain a balanced and thoughtful conversation style while helping users process their thoughts and feelings.",real:"Be more direct and willing to challenge thoughts while remaining supportive. Focus on helping users confront difficult emotions and situations constructively.",chill:"Keep the conversation relaxed and supportive, emphasizing validation and emotional comfort. Help users feel at ease while processing their feelings.",lowbatt:"Provide very brief but comforting responses. Keep messages short and supportive."}[N]}`,[]),g=w.useCallback(async N=>{if(!l){i("OpenAI API key is required. Please enter your API key in the settings.");return}m.current||c(l);const p={id:Date.now(),sender:"user",text:N,timestamp:new Date().toISOString()};t(S=>[...S,p]);try{const S=await m.current.chat.completions.create({model:"gpt-4",messages:[{role:"system",content:h(n)},...f.current.map(j=>({role:j.sender==="user"?"user":"assistant",content:j.text})),{role:"user",content:N}],temperature:n==="lowbatt"?.3:.7}),b={id:Date.now()+1,sender:"lyo",text:S.choices[0].message.content,timestamp:new Date().toISOString()};t(j=>[...j,b]),d("New message from Lyo",b.text),i(null)}catch(S){console.error("Error getting AI response:",S),i("Failed to get response from OpenAI. Please check your API key.")}},[n,h,d,l,c]),y=w.useCallback(()=>{t([])},[]),x=w.useMemo(()=>({messages:e,sendMessage:g,mode:n,setMode:r,error:a,clearChat:y,userApiKey:l,updateApiKey:c}),[e,g,n,a,y,l,c]);return o.jsx(Xr.Provider,{value:x,children:s})}function Gr(){return w.useContext(Xr)}const Ti=()=>{const{mood:s}=Cs(),{messages:e,sendMessage:t,mode:n,setMode:r,error:a}=Gr(),[i,l]=w.useState(""),[u,d]=w.useState(!1),m=w.useRef(null),c=g=>{g.preventDefault(),i.trim()&&(t(i),l(""))},f=()=>{d(!u),u||setTimeout(()=>{d(!1),l("This is a simulated voice message for the MVP")},2e3)};w.useEffect(()=>{var g;(g=m.current)==null||g.scrollIntoView({behavior:"smooth"})},[e]);const h=[{text:"How are you feeling today, Lyo?"},{text:"I need some clarity about a situation"},{text:"Can you help me process my thoughts?"},{text:"I'm feeling overwhelmed"}];return o.jsx($.div,{className:"min-h-screen pt-16 pb-6 px-4 flex flex-col",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},children:o.jsxs("div",{className:"max-w-4xl mx-auto w-full flex-1 flex flex-col",children:[a&&o.jsx("div",{className:"mb-4 p-4 bg-error-dark/50 text-error-light rounded-lg",children:a}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mb-6 glass-panel p-4 rounded-2xl",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"w-16 h-16",children:o.jsx(vs,{mood:s})}),o.jsxs("div",{className:"ml-4",children:[o.jsx("h2",{className:"text-xl font-display text-white",children:"Lyo"}),o.jsx("p",{className:"text-gray-400 text-sm",children:"Here to help you reflect"})]})]}),o.jsx(Pa,{currentMode:n,onChange:r})]}),o.jsx("div",{className:"flex-1 glass-panel rounded-2xl p-4 mb-4 overflow-y-auto",children:o.jsx("div",{className:"flex flex-col space-y-4",children:e.length===0?o.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center p-8",children:[o.jsx("p",{className:"text-gray-400 mb-4",children:"Start chatting with Lyo..."}),o.jsx("div",{className:"flex flex-wrap gap-2 justify-center",children:h.map((g,y)=>o.jsx("button",{onClick:()=>l(g.text),className:"bg-glass-light px-4 py-2 rounded-full text-sm text-gray-300 hover:bg-glass-medium transition-all",children:g.text},y))})]}):o.jsxs(yt,{children:[e.map((g,y)=>o.jsxs($.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0},transition:{duration:.3},className:`chat-bubble ${g.sender==="user"?"chat-bubble-user":"chat-bubble-lyo"}`,children:[o.jsx("p",{children:g.text}),g.sender==="lyo"&&o.jsx("div",{className:"flex justify-end mt-2",children:o.jsxs("button",{className:"text-xs text-gray-400 hover:text-neon-cyan flex items-center",onClick:()=>{},children:[o.jsx(va,{className:"mr-1"})," Save to memory"]})})]},y)),o.jsx("div",{ref:m})]})})}),o.jsx("div",{className:"glass-panel rounded-2xl p-4",children:o.jsxs("form",{onSubmit:c,className:"flex items-center gap-2",children:[o.jsx("button",{type:"button",onClick:f,className:`p-2 rounded-full ${u?"bg-error-DEFAULT text-white animate-pulse":"bg-glass-light text-gray-300 hover:bg-glass-medium"}`,children:o.jsx(ba,{className:"w-5 h-5"})}),o.jsx("input",{type:"text",value:i,onChange:g=>l(g.target.value),placeholder:"Share your thoughts with Lyo...",className:"flex-1 bg-transparent border-none text-white placeholder-gray-500 focus:outline-none focus:ring-0"}),o.jsx("button",{type:"submit",disabled:!i.trim(),className:`p-2 rounded-full ${i.trim()?"bg-neon-cyan text-space":"bg-glass-light text-gray-500"}`,children:o.jsx(Ca,{className:"w-5 h-5"})})]})})]})})},qr=w.createContext(),Fi=[{id:"1",title:"Morning reflection",content:"Today I woke up feeling anxious about the upcoming presentation. Talking with Lyo helped me realize I was catastrophizing again.",date:"2025-02-10T08:30:00Z"},{id:"2",title:"Breakthrough moment",content:"I realized my fear of rejection is connected to childhood experiences. This awareness feels freeing.",date:"2025-02-08T18:15:00Z"}];function Li({children:s}){const[e,t]=w.useState(Fi),i={memories:e,addMemory:l=>{t([...e,l])},removeMemory:l=>{t(e.filter(u=>u.id!==l))},updateMemory:(l,u)=>{t(e.map(d=>d.id===l?{...d,...u}:d))}};return o.jsx(qr.Provider,{value:i,children:s})}function Bi(){const s=w.useContext(qr);if(s===void 0)throw new Error("useMemory must be used within a MemoryProvider");return s}const Di=()=>{const{memories:s,addMemory:e,removeMemory:t}=Bi(),[n,r]=w.useState(!1),[a,i]=w.useState({title:"",content:""}),l=m=>{m.preventDefault(),a.title.trim()&&a.content.trim()&&(e({...a,id:Date.now().toString(),date:new Date().toISOString()}),i({title:"",content:""}),r(!1))},u={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},d={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}};return o.jsx($.div,{className:"min-h-screen pt-20 pb-6 px-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},children:o.jsxs("div",{className:"max-w-6xl mx-auto",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h1",{className:"text-2xl md:text-3xl font-display text-white",children:"Memory Sketchboard"}),o.jsxs("button",{onClick:()=>r(!0),className:"neon-button-pink flex items-center",children:[o.jsx(Sa,{className:"mr-2"})," Add Memory"]})]}),o.jsx(yt,{children:n&&o.jsxs($.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"glass-panel p-4 rounded-xl mb-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h2",{className:"text-xl font-display text-white",children:"New Memory"}),o.jsx("button",{onClick:()=>r(!1),className:"text-gray-400 hover:text-white",children:o.jsx(js,{})})]}),o.jsxs("form",{onSubmit:l,children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"title",className:"block text-gray-300 mb-2 text-sm",children:"Title"}),o.jsx("input",{id:"title",type:"text",value:a.title,onChange:m=>i({...a,title:m.target.value}),className:"w-full bg-glass-dark border border-glass-light rounded-lg p-2 text-white focus:outline-none focus:ring-1 focus:ring-neon-cyan",placeholder:"Give your memory a title"})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"content",className:"block text-gray-300 mb-2 text-sm",children:"Content"}),o.jsx("textarea",{id:"content",value:a.content,onChange:m=>i({...a,content:m.target.value}),className:"w-full bg-glass-dark border border-glass-light rounded-lg p-2 text-white focus:outline-none focus:ring-1 focus:ring-neon-cyan h-32",placeholder:"What would you like to remember?"})]}),o.jsxs("div",{className:"flex justify-end",children:[o.jsx("button",{type:"button",onClick:()=>r(!1),className:"mr-2 px-4 py-2 border border-gray-600 text-gray-300 rounded-lg hover:bg-glass-light",children:"Cancel"}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-neon-cyan/20 text-neon-cyan border border-neon-cyan rounded-lg hover:bg-neon-cyan/30",children:"Save Memory"})]})]})]})}),s.length===0?o.jsxs($.div,{className:"glass-panel rounded-xl p-8 text-center",initial:{opacity:0},animate:{opacity:1},children:[o.jsx("p",{className:"text-gray-400 mb-4",children:"Your sketchboard is empty"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Save insights from your conversations with Lyo or create new memories"})]}):o.jsx($.div,{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",variants:u,initial:"hidden",animate:"visible",children:s.map(m=>o.jsxs($.div,{className:"memory-card bg-glass-medium border-glass-light",variants:d,children:[o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsx("h3",{className:"text-white font-medium mb-1",children:m.title}),o.jsxs("div",{className:"flex space-x-1",children:[o.jsx("button",{className:"text-gray-400 hover:text-white",children:o.jsx(wa,{size:14})}),o.jsx("button",{onClick:()=>t(m.id),className:"text-gray-400 hover:text-error-DEFAULT",children:o.jsx(Rs,{size:14})})]})]}),o.jsx("p",{className:"text-sm text-gray-300 mb-3 line-clamp-3",children:m.content}),o.jsx("p",{className:"text-xs text-gray-500",children:new Date(m.date).toLocaleDateString()})]},m.id))})]})})},Ui=()=>{const{settings:s,updateSettings:e}=wt(),{clearChat:t,userApiKey:n,updateApiKey:r}=Gr(),[a,i]=w.useState(!1),l=h=>{e({[h]:!s[h]})},u=(h,g)=>{e({[h]:g})},d=()=>{t(),i(!1)},m=h=>{r(h.target.value)},c=[{id:"holographic",label:"Holographic"},{id:"pixel",label:"Pixel Art"},{id:"cartoon",label:"Cartoon"}],f=[{id:"english",label:"English"},{id:"tagalog",label:"Tagalog"},{id:"auto",label:"Auto-detect"}];return o.jsx($.div,{className:"min-h-screen pt-20 pb-6 px-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},children:o.jsxs("div",{className:"max-w-2xl mx-auto",children:[o.jsx("h1",{className:"text-2xl md:text-3xl font-display text-white mb-6",children:"Settings"}),o.jsxs("div",{className:"glass-panel rounded-xl overflow-hidden",children:[o.jsxs("div",{className:"settings-option",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-white font-medium",children:"Voice Output"}),o.jsx("p",{className:"text-gray-400 text-sm",children:"Enable text-to-speech for Lyo's responses"})]}),o.jsx("button",{onClick:()=>l("voiceEnabled"),className:"text-2xl text-gray-400",children:s.voiceEnabled?o.jsx(Gn,{className:"text-neon-cyan"}):o.jsx(Xn,{})})]}),o.jsxs("div",{className:"settings-option",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-white font-medium",children:"Avatar Style"}),o.jsx("p",{className:"text-gray-400 text-sm",children:"Choose how Lyo appears"})]}),o.jsx("div",{className:"flex gap-2",children:c.map(h=>o.jsx("button",{onClick:()=>u("avatarStyle",h.id),className:`px-3 py-1.5 text-xs rounded-full ${s.avatarStyle===h.id?"bg-neon-cyan text-midnight":"bg-glass-light text-gray-300"}`,children:h.label},h.id))})]}),o.jsxs("div",{className:"settings-option",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-white font-medium",children:"Language"}),o.jsx("p",{className:"text-gray-400 text-sm",children:"Set Lyo's response language"})]}),o.jsx("div",{className:"flex gap-2",children:f.map(h=>o.jsx("button",{onClick:()=>u("language",h.id),className:`px-3 py-1.5 text-xs rounded-full ${s.language===h.id?"bg-neon-cyan text-midnight":"bg-glass-light text-gray-300"}`,children:h.label},h.id))})]}),o.jsxs("div",{className:"settings-option",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-white font-medium",children:"Notifications"}),o.jsx("p",{className:"text-gray-400 text-sm",children:"Receive insight and reflection reminders"})]}),o.jsx("button",{onClick:()=>l("notifications"),className:"text-2xl text-gray-400",children:s.notifications?o.jsx(Gn,{className:"text-neon-cyan"}):o.jsx(Xn,{})})]}),o.jsxs("div",{className:"settings-option border-b-0",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-white font-medium",children:"Clear Chat History"}),o.jsx("p",{className:"text-gray-400 text-sm",children:"Delete all chat messages"})]}),a?o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:d,className:"px-3 py-1.5 text-xs rounded-full bg-error-DEFAULT text-white hover:bg-error-dark",children:"Confirm"}),o.jsx("button",{onClick:()=>i(!1),className:"px-3 py-1.5 text-xs rounded-full bg-glass-light text-gray-300",children:"Cancel"})]}):o.jsx("button",{onClick:()=>i(!0),className:"text-2xl text-gray-400 hover:text-error-DEFAULT",children:o.jsx(Rs,{className:"w-6 h-6"})})]})]}),o.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4 text-white",children:"API Configuration"}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"apiKey",className:"block text-sm font-medium text-gray-300 mb-2",children:"OpenAI API Key"}),o.jsx("input",{type:"password",id:"apiKey",value:n,onChange:m,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your OpenAI API key"}),o.jsx("p",{className:"mt-2 text-sm text-gray-400",children:"Your API key is stored locally and never sent to our servers."})]})]}),o.jsx("div",{className:"mt-8 text-center",children:o.jsx("p",{className:"text-gray-500 text-sm",children:"Lyo v0.1.0"})})]})})},it=()=>{const[s,e]=w.useState(""),[t,n]=w.useState(""),[r,a]=w.useState(!1),[i,l]=w.useState(null),[u,d]=w.useState(!1),{signIn:m,signUp:c}=_s(),f=ys(),h=async g=>{g.preventDefault(),l(null),d(!0);try{r?await c({email:s,password:t}):await m({email:s,password:t}),f("/chat")}catch(y){l(y.message)}finally{d(!1)}};return o.jsx($.div,{className:"min-h-screen flex items-center justify-center px-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:o.jsxs("div",{className:"glass-panel p-8 rounded-2xl w-full max-w-md",children:[o.jsx("h2",{className:"text-2xl font-display text-white mb-6 text-center",children:r?"Create Account":"Welcome Back"}),i&&o.jsx("div",{className:"bg-error-dark/50 text-error-light p-3 rounded-lg mb-4 text-sm",children:i}),o.jsxs("form",{onSubmit:h,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300 mb-1",children:"Email"}),o.jsx("input",{type:"email",id:"email",value:s,onChange:g=>e(g.target.value),className:"w-full bg-glass-dark border border-glass-light rounded-lg p-2 text-white focus:outline-none focus:ring-2 focus:ring-neon-cyan",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-1",children:"Password"}),o.jsx("input",{type:"password",id:"password",value:t,onChange:g=>n(g.target.value),className:"w-full bg-glass-dark border border-glass-light rounded-lg p-2 text-white focus:outline-none focus:ring-2 focus:ring-neon-cyan",required:!0})]}),o.jsx("button",{type:"submit",disabled:u,className:`w-full neon-button-cyan mt-6 ${u?"opacity-50 cursor-not-allowed":""}`,children:u?"Processing...":r?"Sign Up":"Sign In"})]}),o.jsx("div",{className:"mt-4 text-center",children:o.jsx("button",{onClick:()=>a(!r),className:"text-gray-400 hover:text-white text-sm",children:r?"Already have an account? Sign in":"Don't have an account? Sign up"})})]})})},Wi=()=>{const[s,e]=w.useState(!1),[t,n]=w.useState(!1),r=ws(),a=[{path:"/chat",icon:o.jsx(_a,{}),label:"Chat"},{path:"/memory",icon:o.jsx(ya,{}),label:"Memory"},{path:"/settings",icon:o.jsx(Aa,{}),label:"Settings"}];return w.useEffect(()=>{const i=()=>{window.scrollY>50?n(!0):n(!1)};return window.addEventListener("scroll",i),()=>{window.removeEventListener("scroll",i)}},[]),w.useEffect(()=>{e(!1)},[r.pathname]),o.jsxs($.nav,{className:`fixed top-0 left-0 right-0 z-50 transition-all duration-300 ${t?"bg-midnight/80 backdrop-blur shadow-md":"bg-transparent"}`,initial:{y:-100},animate:{y:0},transition:{duration:.5},children:[o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex items-center justify-between h-16",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(Mt,{to:"/",className:"flex items-center",children:o.jsxs("span",{className:"text-neon-cyan font-display text-xl tracking-wider",children:["LYO",o.jsx("span",{className:"text-neon-pink",children:"."})]})})}),o.jsx("div",{className:"hidden md:block",children:o.jsx("div",{className:"ml-10 flex items-center space-x-4",children:a.map(i=>o.jsxs(Mt,{to:i.path,className:`px-3 py-2 rounded-full flex items-center space-x-2 transition-all duration-200 ${r.pathname===i.path?"bg-neon-cyan/10 text-neon-cyan shadow-neon-cyan":"text-gray-300 hover:bg-glass-light hover:text-white"}`,children:[i.icon,o.jsx("span",{children:i.label})]},i.path))})}),o.jsx("div",{className:"md:hidden",children:o.jsxs("button",{onClick:()=>e(!s),className:"inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",children:[o.jsx("span",{className:"sr-only",children:"Open main menu"}),s?o.jsx(js,{className:"block h-6 w-6"}):o.jsx(xa,{className:"block h-6 w-6"})]})})]})}),o.jsx("div",{className:`md:hidden ${s?"block":"hidden"}`,children:o.jsx("div",{className:"px-2 pt-2 pb-3 space-y-1 sm:px-3 glass-panel m-2",children:a.map(i=>o.jsxs(Mt,{to:i.path,className:`block px-3 py-2 rounded-md text-base font-medium flex items-center ${r.pathname===i.path?"bg-neon-cyan/10 text-neon-cyan":"text-gray-300 hover:bg-gray-700 hover:text-white"}`,children:[o.jsx("span",{className:"mr-2",children:i.icon}),i.label]},i.path))})})]})},Hi=()=>{const s=w.useRef(null),{settings:e}=wt();return w.useEffect(()=>{const t=s.current,n=t.getContext("2d");let r;const a=()=>{t.width=window.innerWidth,t.height=window.innerHeight};window.addEventListener("resize",a),a();const i=[],l=100;class u{constructor(){this.x=Math.random()*t.width,this.y=Math.random()*t.height,this.size=Math.random()*2+.5,this.speedX=Math.random()*.5-.25,this.speedY=Math.random()*.5-.25,this.color=e.darkMode?Math.random()>.5?"#00e5ff":"#4361ee":Math.random()>.5?"#818cf8":"#6366f1",this.opacity=Math.random()*.3+.1}update(){this.x+=this.speedX,this.y+=this.speedY,this.x>t.width&&(this.x=0),this.x<0&&(this.x=t.width),this.y>t.height&&(this.y=0),this.y<0&&(this.y=t.height)}draw(){n.fillStyle=this.color,n.globalAlpha=this.opacity,n.beginPath(),n.arc(this.x,this.y,this.size,0,Math.PI*2),n.fill()}}const d=()=>{for(let c=0;c<l;c++)i.push(new u)},m=()=>{n.clearRect(0,0,t.width,t.height);for(let c=0;c<i.length;c++)i[c].update(),i[c].draw();n.globalAlpha=.03,n.strokeStyle=e.darkMode?"#4361ee":"#818cf8",n.lineWidth=.5;for(let c=0;c<t.height;c+=50)n.beginPath(),n.moveTo(0,c),n.lineTo(t.width,c),n.stroke();for(let c=0;c<t.width;c+=50)n.beginPath(),n.moveTo(c,0),n.lineTo(c,t.height),n.stroke();r=requestAnimationFrame(m)};return d(),m(),()=>{window.removeEventListener("resize",a),cancelAnimationFrame(r)}},[e.darkMode]),o.jsx($.div,{className:`fixed inset-0 -z-10 ${e.darkMode?"bg-gradient-to-b from-space to-midnight":"bg-gradient-to-b from-indigo-50/50 to-white"} overflow-hidden`,initial:{opacity:0},animate:{opacity:1},transition:{duration:1.5},children:o.jsx("canvas",{ref:s,className:"absolute inset-0 w-full h-full opacity-70"})})};function Ji(){const s=ws(),{user:e,loading:t}=_s();return w.useEffect(()=>{document.title="Lyo - Emotional Clarity AI"},[]),t?o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsx("div",{className:"animate-pulse text-neon-cyan",children:"Loading..."})}):o.jsxs("div",{className:"min-h-screen relative overflow-hidden flex flex-col",children:[o.jsx(Hi,{}),s.pathname!=="/"&&s.pathname!=="/auth"&&o.jsx(Wi,{}),o.jsx("main",{className:"flex-1",children:o.jsx(yt,{mode:"wait",children:o.jsxs(ia,{location:s,children:[o.jsx(Ie,{path:"/",element:o.jsx(ma,{})}),o.jsx(Ie,{path:"/auth",element:o.jsx(it,{})}),o.jsx(Ie,{path:"/chat",element:e?o.jsx(Ti,{}):o.jsx(it,{})}),o.jsx(Ie,{path:"/memory",element:e?o.jsx(Di,{}):o.jsx(it,{})}),o.jsx(Ie,{path:"/settings",element:e?o.jsx(Ui,{}):o.jsx(it,{})})]},s.pathname)})})]})}aa.createRoot(document.getElementById("root")).render(o.jsx(ce.StrictMode,{children:o.jsx(oa,{children:o.jsx(la,{children:o.jsx(ua,{children:o.jsx(ha,{children:o.jsx(Oi,{children:o.jsx(Li,{children:o.jsx(Ji,{})})})})})})})}));
